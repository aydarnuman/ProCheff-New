<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProCheff Maliyet Sim√ºlasyonu v1.0 - Faz 8: Trend Zek√¢sƒ±</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Cost Simulation Color Palette */
            --primary-950: #0C0F14;
            --primary-900: #1A1D24;
            --primary-850: #232936;
            --primary-800: #2D3441;
            --primary-700: #3B4252;
            --primary-600: #4C566A;
            
            --cost-green: #22C55E;
            --cost-yellow: #F59E0B;
            --cost-red: #EF4444;
            --cost-blue: #3B82F6;
            --cost-purple: #8B5CF6;
            --cost-orange: #F97316;
            
            --text-primary: #F1F5F9;
            --text-secondary: #CBD5E1;
            --text-muted: #94A3B8;
            
            --gradient-primary: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            --gradient-cost: linear-gradient(135deg, #f59e0b 0%, #ea580c 50%, #dc2626 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--primary-950);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Ana Container */
        .cost-simulation-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            height: 100vh;
            gap: 0;
        }

        /* Sol Panel - Navigation */
        .nav-panel {
            background: linear-gradient(180deg, var(--primary-900) 0%, var(--primary-850) 100%);
            border-right: 1px solid rgba(245, 158, 11, 0.2);
            padding: 24px 20px;
            overflow-y: auto;
        }

        .nav-header {
            text-align: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(245, 158, 11, 0.2);
        }

        .logo {
            font-size: 22px;
            font-weight: 800;
            background: var(--gradient-cost);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .version-badge {
            background: var(--gradient-cost);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            padding-left: 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 4px;
        }

        .nav-item:hover {
            background: rgba(245, 158, 11, 0.1);
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .nav-item.active {
            background: var(--gradient-cost);
            color: white;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .nav-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        /* Ana Panel */
        .main-panel {
            background: var(--primary-950);
            padding: 32px;
            overflow-y: auto;
        }

        .main-header {
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
            background: var(--gradient-cost);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-subtitle {
            font-size: 16px;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Recipe Selection Section */
        .recipe-selection {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .recipe-card {
            background: rgba(45, 52, 65, 0.4);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .recipe-card:hover {
            transform: translateY(-2px);
            border-color: var(--cost-orange);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
        }

        .recipe-card.selected {
            background: rgba(245, 158, 11, 0.2);
            border-color: var(--cost-orange);
        }

        .recipe-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .recipe-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .simulate-button {
            width: 100%;
            background: var(--gradient-cost);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .simulate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .simulate-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Market Comparison Table */
        .market-comparison {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            display: none;
        }

        .market-comparison.show {
            display: block;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(75, 85, 99, 0.3);
        }

        .comparison-table th {
            background: rgba(45, 52, 65, 0.6);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .comparison-table td {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .market-logo {
            font-size: 18px;
            margin-right: 8px;
        }

        .cost-value {
            font-weight: 700;
            font-size: 15px;
        }

        .cost-low { color: var(--cost-green); }
        .cost-medium { color: var(--cost-yellow); }
        .cost-high { color: var(--cost-red); }

        .quality-score {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .quality-bar {
            width: 40px;
            height: 4px;
            background: rgba(75, 85, 99, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .quality-fill {
            height: 100%;
            border-radius: 2px;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-good {
            background: rgba(34, 197, 94, 0.2);
            color: var(--cost-green);
        }

        .status-medium {
            background: rgba(245, 158, 11, 0.2);
            color: var(--cost-yellow);
        }

        .status-risky {
            background: rgba(239, 68, 68, 0.2);
            color: var(--cost-red);
        }

        /* AI Recommendation Panel */
        .ai-recommendation {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .recommendation-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .recommendation-content {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }

        .thinking-chain {
            background: rgba(45, 52, 65, 0.4);
            border-radius: 12px;
            padding: 16px;
            margin: 12px 0;
        }

        .thinking-step {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .step-icon {
            color: var(--cost-purple);
            margin-top: 2px;
        }

        /* Animasyonlar */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .processing {
            background: linear-gradient(90deg, 
                rgba(245, 158, 11, 0.1) 25%, 
                rgba(245, 158, 11, 0.3) 50%, 
                rgba(245, 158, 11, 0.1) 75%);
            background-size: 200% 100%;
            animation: processing 2s infinite;
        }

        @keyframes processing {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* 3 Scenario Analysis Panels */
        .scenario-analysis {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .scenario-panel {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .scenario-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .scenario-panel.cheapest::before {
            background: var(--cost-green);
        }

        .scenario-panel.balanced::before {
            background: var(--cost-yellow);
        }

        .scenario-panel.premium::before {
            background: var(--cost-purple);
        }

        .scenario-panel:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .scenario-panel.selected {
            border-color: var(--cost-orange);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.2);
        }

        .scenario-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .scenario-icon {
            font-size: 24px;
        }

        .scenario-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .scenario-badge {
            margin-left: auto;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-cheapest {
            background: rgba(34, 197, 94, 0.2);
            color: var(--cost-green);
        }

        .badge-balanced {
            background: rgba(245, 158, 11, 0.2);
            color: var(--cost-yellow);
        }

        .badge-premium {
            background: rgba(139, 92, 246, 0.2);
            color: var(--cost-purple);
        }

        .scenario-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .metric-item {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }

        .metric-value {
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .scenario-description {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .scenario-markets {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .market-tag {
            background: rgba(45, 52, 65, 0.8);
            color: var(--text-secondary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 500;
        }

        /* Market Research Analysis - Normalized Pricing */
        .market-research {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            display: none;
        }

        .market-research.show {
            display: block;
        }

        .research-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .research-controls {
            display: flex;
            gap: 12px;
        }

        .control-button {
            background: rgba(59, 130, 246, 0.2);
            color: var(--cost-blue);
            border: 1px solid rgba(59, 130, 246, 0.3);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            background: rgba(59, 130, 246, 0.3);
            color: var(--text-primary);
        }

        .control-button.active {
            background: var(--cost-blue);
            color: white;
        }

        /* Normalized Price Table */
        .normalized-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            overflow: hidden;
        }

        .normalized-table th,
        .normalized-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(75, 85, 99, 0.2);
        }

        .normalized-table th {
            background: rgba(35, 41, 55, 0.8);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .normalized-table td {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .price-original {
            color: var(--text-muted);
            font-size: 12px;
        }

        .price-normalized {
            font-weight: 700;
            font-size: 14px;
        }

        .deviation-positive {
            color: var(--cost-red);
        }

        .deviation-negative {
            color: var(--cost-green);
        }

        .deviation-neutral {
            color: var(--cost-yellow);
        }

        .status-icon {
            font-size: 16px;
            margin-right: 4px;
        }

        .freshness-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .fresh { background: var(--cost-green); }
        .medium { background: var(--cost-yellow); }
        .old { background: var(--cost-red); }

        /* Analysis Summary Cards */
        .analysis-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .summary-card {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(75, 85, 99, 0.3);
        }

        .summary-value {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .summary-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .summary-trend {
            font-size: 12px;
            margin-top: 4px;
        }

        /* AI Insights Panel */
        .ai-insights {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }

        .insights-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .insights-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .insights-content {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .insight-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
        }

        .insight-icon {
            color: var(--cost-purple);
            margin-top: 2px;
        }

        /* Scenario Comparison Table */
        .scenario-comparison {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            display: none;
        }

        .scenario-comparison.show {
            display: block;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 16px;
        }

        .comparison-card {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            position: relative;
        }

        .comparison-card.winner {
            border: 2px solid var(--cost-orange);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
        }

        .comparison-card.winner::after {
            content: 'üëë';
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 20px;
        }

        .comparison-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .comparison-cost {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .comparison-details {
            font-size: 11px;
            color: var(--text-muted);
            line-height: 1.3;
        }

        /* AI Scenario Recommendation */
        .scenario-recommendation {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .recommendation-scenario {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .recommended-badge {
            background: var(--cost-purple);
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Faz 8: Trend Analysis Styles */
        .trend-analysis {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .trend-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .trend-controls {
            display: flex;
            gap: 8px;
        }

        .trend-button {
            background: rgba(45, 52, 65, 0.6);
            border: 1px solid rgba(75, 85, 99, 0.3);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .trend-button:hover {
            border-color: var(--cost-orange);
            color: var(--text-primary);
        }

        .trend-button.active {
            background: var(--gradient-cost);
            border-color: var(--cost-orange);
            color: white;
        }

        .trend-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            overflow: hidden;
        }

        .trend-table th,
        .trend-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(75, 85, 99, 0.2);
        }

        .trend-table th {
            background: rgba(35, 41, 55, 0.8);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .trend-table td {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .trend-direction {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .trend-icon {
            font-size: 18px;
        }

        .trend-up { color: var(--cost-red); }
        .trend-down { color: var(--cost-green); }
        .trend-stable { color: var(--cost-yellow); }

        .sparkline {
            font-family: monospace;
            font-size: 14px;
            letter-spacing: 1px;
            color: var(--cost-blue);
        }

        .price-change {
            font-weight: 700;
        }

        .price-change.positive {
            color: var(--cost-red);
        }

        .price-change.negative {
            color: var(--cost-green);
        }

        .price-change.neutral {
            color: var(--cost-yellow);
        }

        .trend-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .trend-summary-card {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(75, 85, 99, 0.3);
        }

        .trend-summary-value {
            font-size: 18px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .trend-summary-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .trend-summary-detail {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .export-button {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid var(--cost-blue);
            color: var(--cost-blue);
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-button:hover {
            background: var(--cost-blue);
            color: white;
        }

        /* Faz 7.3: Combination AI Styles */
        .combination-ai {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .combination-summary {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .summary-header h3 {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 700;
        }

        .optimization-score {
            text-align: center;
        }

        .score-value {
            display: block;
            font-size: 24px;
            font-weight: 800;
            color: var(--cost-green);
        }

        .score-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .combination-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .ingredient-assignment {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 16px;
            border-left: 4px solid var(--cost-blue);
        }

        .ingredient-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .ingredient-icon {
            font-size: 20px;
        }

        .ingredient-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .assigned-market {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .market-logo {
            font-size: 16px;
        }

        .market-name {
            font-weight: 700;
            color: var(--cost-blue);
        }

        .assignment-reason {
            font-size: 11px;
            color: var(--text-muted);
            margin-left: auto;
        }

        .assignment-metrics {
            display: flex;
            gap: 12px;
        }

        .metric {
            font-size: 10px;
            color: var(--text-secondary);
            background: rgba(59, 130, 246, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .ai-logic-chain {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .chain-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .logic-steps {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .logic-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .step-number {
            background: var(--cost-blue);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-content {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .combination-comparison {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
        }

        .comparison-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .combination-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(35, 41, 55, 0.8);
            border-radius: 8px;
            overflow: hidden;
        }

        .combination-table th,
        .combination-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(75, 85, 99, 0.2);
        }

        .combination-table th {
            background: rgba(75, 85, 99, 0.3);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 12px;
            text-transform: uppercase;
        }

        .combination-table td {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .optimal-row {
            background: rgba(34, 197, 94, 0.1);
            border-left: 3px solid var(--cost-green);
        }

        .optimal-row td {
            color: var(--text-primary);
        }

        .advantage-positive {
            color: var(--cost-green);
            font-weight: 700;
        }

        .advantage-negative {
            color: var(--cost-red);
            font-weight: 700;
        }

        /* Faz 7.4: Quality Integration Styles */
        .quality-integration {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .effective-cost-analysis {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .analysis-header h3 {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 700;
        }

        .confidence-score {
            text-align: center;
        }

        .confidence-value {
            display: block;
            font-size: 24px;
            font-weight: 800;
            color: var(--cost-green);
        }

        .confidence-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .cost-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .breakdown-card {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 16px;
            border-left: 4px solid var(--cost-blue);
        }

        .breakdown-card.penalty {
            border-left-color: var(--cost-orange);
        }

        .breakdown-card.total {
            border-left-color: var(--cost-green);
            background: rgba(34, 197, 94, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .card-icon {
            font-size: 18px;
        }

        .card-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .cost-details {
            text-align: center;
        }

        .primary-cost {
            font-size: 20px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .risk-cost {
            color: var(--cost-orange);
        }

        .effective-cost {
            color: var(--cost-green);
        }

        .cost-description {
            font-size: 11px;
            color: var(--text-muted);
        }

        .quality-risk-matrix {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .matrix-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .risk-matrix-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(35, 41, 55, 0.8);
            border-radius: 8px;
            overflow: hidden;
        }

        .risk-matrix-table th,
        .risk-matrix-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(75, 85, 99, 0.2);
        }

        .risk-matrix-table th {
            background: rgba(75, 85, 99, 0.3);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 11px;
            text-transform: uppercase;
        }

        .risk-matrix-table td {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .risk-very-low {
            border-left: 3px solid var(--cost-green);
        }

        .risk-low {
            border-left: 3px solid var(--cost-yellow);
        }

        .risk-medium {
            border-left: 3px solid var(--cost-orange);
        }

        .risk-high {
            border-left: 3px solid var(--cost-red);
        }

        .quality-score {
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(34, 197, 94, 0.2);
            color: var(--cost-green);
        }

        .risk-factor {
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
        }

        .risk-factor.risk-very-low {
            background: rgba(34, 197, 94, 0.2);
            color: var(--cost-green);
        }

        .risk-factor.risk-low {
            background: rgba(245, 158, 11, 0.2);
            color: var(--cost-yellow);
        }

        .risk-factor.risk-medium {
            background: rgba(249, 115, 22, 0.2);
            color: var(--cost-orange);
        }

        .risk-factor.risk-high {
            background: rgba(239, 68, 68, 0.2);
            color: var(--cost-red);
        }

        .effective-price {
            font-weight: 700;
            color: var(--text-primary);
        }

        .confidence-details {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
        }

        .details-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .confidence-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .metric-card {
            background: rgba(35, 41, 55, 0.8);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(75, 85, 99, 0.3);
        }

        .metric-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 18px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .metric-detail {
            font-size: 10px;
            color: var(--text-muted);
        }

        /* Faz 7.5: Market Memory Styles */
        .market-memory {
            background: rgba(35, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .learning-status {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .status-header h3 {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 700;
        }

        .learning-progress {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .progress-bar {
            width: 150px;
            height: 6px;
            background: rgba(45, 52, 65, 0.6);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--cost-purple);
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 12px;
            font-weight: 600;
            color: var(--cost-purple);
        }

        .learning-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .metric-box {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 8px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .metric-box .metric-icon {
            font-size: 20px;
        }

        .metric-number {
            font-size: 18px;
            font-weight: 800;
            color: var(--text-primary);
        }

        .metric-label {
            font-size: 11px;
            color: var(--text-muted);
        }

        .pattern-recognition {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .pattern-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .pattern-card {
            background: rgba(35, 41, 55, 0.8);
            border-radius: 8px;
            padding: 16px;
            border-left: 4px solid var(--cost-blue);
        }

        .pattern-card.detected {
            border-left-color: var(--cost-green);
        }

        .pattern-card.learning {
            border-left-color: var(--cost-yellow);
        }

        .pattern-card.pending {
            border-left-color: var(--text-muted);
        }

        .pattern-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .pattern-icon {
            font-size: 16px;
        }

        .detection-badge {
            margin-left: auto;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .detection-badge:not(.learning):not(.pending) {
            background: rgba(34, 197, 94, 0.2);
            color: var(--cost-green);
        }

        .detection-badge.learning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--cost-yellow);
        }

        .detection-badge.pending {
            background: rgba(156, 163, 175, 0.2);
            color: var(--text-muted);
        }

        .pattern-insight {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 4px;
        }

        .pattern-confidence {
            font-size: 10px;
            color: var(--text-muted);
            font-weight: 600;
        }

        .auto-coefficients {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .coefficients-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .coefficients-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(35, 41, 55, 0.8);
            border-radius: 8px;
            overflow: hidden;
        }

        .coefficients-table th,
        .coefficients-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(75, 85, 99, 0.2);
        }

        .coefficients-table th {
            background: rgba(75, 85, 99, 0.3);
            font-weight: 600;
            color: var(--text-primary);
            font-size: 11px;
            text-transform: uppercase;
        }

        .coefficients-table td {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .coefficient-positive {
            border-left: 3px solid var(--cost-green);
        }

        .coefficient-negative {
            border-left: 3px solid var(--cost-red);
        }

        .coefficient-stable {
            border-left: 3px solid var(--cost-yellow);
        }

        .current-weight {
            font-weight: 700;
            color: var(--text-primary);
        }

        .weight-change {
            font-weight: 600;
        }

        .weight-change.positive {
            color: var(--cost-green);
        }

        .weight-change.negative {
            color: var(--cost-red);
        }

        .weight-change.stable {
            color: var(--cost-yellow);
        }

        .learning-history {
            background: rgba(45, 52, 65, 0.6);
            border-radius: 12px;
            padding: 20px;
        }

        .history-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .history-timeline {
            position: relative;
            padding-left: 24px;
        }

        .history-timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: rgba(75, 85, 99, 0.3);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
        }

        .timeline-marker {
            position: absolute;
            left: -20px;
            top: 4px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--cost-blue);
        }

        .timeline-item.recent .timeline-marker {
            background: var(--cost-green);
        }

        .timeline-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .timeline-details {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .timeline-time {
            font-size: 10px;
            color: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .scenario-analysis {
                grid-template-columns: 1fr;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .trend-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 1024px) {
            .cost-simulation-container {
                grid-template-columns: 1fr;
            }

            .nav-panel {
                display: none;
            }

            .recipe-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .scenario-analysis {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="cost-simulation-container">
        <!-- Sol Panel - Navigation -->
        <div class="nav-panel">
            <div class="nav-header">
                <div class="logo">üí∞ ProCheff AI</div>
                <div class="version-badge">Cost Sim v1.0</div>
            </div>

            <nav>
                <div class="nav-section">
                    <div class="nav-title">Ana Mod√ºller</div>
                    <a href="../index.html" class="nav-item">
                        <span class="nav-icon">üè†</span>
                        <span>Ana Sayfa</span>
                    </a>
                    <a href="../dashboard/index.html" class="nav-item">
                        <span class="nav-icon">ÔøΩ</span>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item active">
                        <span class="nav-icon">üí∞</span>
                        <span>Maliyet Sim√ºlasyonu</span>
                    </a>
                    <a href="../ai-settings/index.html" class="nav-item">
                        <span class="nav-icon">üß†</span>
                        <span>AI Ayarlarƒ±</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Faz 7 √ñzellikleri</div>
                    <a href="#recipe-selection" class="nav-item">
                        <span class="nav-icon">üç≥</span>
                        <span>Tarif Se√ßimi</span>
                    </a>
                    <a href="#market-research" class="nav-item">
                        <span class="nav-icon">üîç</span>
                        <span>Birim Fiyat Analizi</span>
                    </a>
                    <a href="#market-comparison" class="nav-item">
                        <span class="nav-icon">üè™</span>
                        <span>Market Kar≈üƒ±la≈ütƒ±rmasƒ±</span>
                    </a>
                    <a href="#ai-recommendation" class="nav-item">
                        <span class="nav-icon">ü§ñ</span>
                        <span>AI √ñnerisi</span>
                    </a>
                    <a href="#scenarios" class="nav-item">
                        <span class="nav-icon">üìä</span>
                        <span>3 Senaryo Analizi</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Faz 8 - Trend Zek√¢sƒ±</div>
                    <a href="#trend-analysis" class="nav-item">
                        <span class="nav-icon">üìà</span>
                        <span>Fiyat Trend Analizi</span>
                    </a>
                    <a href="#price-movement" class="nav-item">
                        <span class="nav-icon">‚ö°</span>
                        <span>30 G√ºn Hareket</span>
                    </a>
                    <a href="#sparkline-chart" class="nav-item">
                        <span class="nav-icon">üìä</span>
                        <span>Mini Grafikler</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Faz 7.3 - Kombinasyon</div>
                    <a href="#combination-ai" class="nav-item">
                        <span class="nav-icon">üß†</span>
                        <span>Karma Kombinasyon AI</span>
                    </a>
                    <a href="#optimal-selection" class="nav-item">
                        <span class="nav-icon">üéØ</span>
                        <span>Optimal Market Se√ßimi</span>
                    </a>
                    <a href="#logistics-factor" class="nav-item">
                        <span class="nav-icon">üìç</span>
                        <span>Lojistik Fakt√∂r</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Faz 7.4 - Kalite</div>
                    <a href="#quality-integration" class="nav-item">
                        <span class="nav-icon">‚ö°</span>
                        <span>Kalite Katsayƒ±sƒ±</span>
                    </a>
                    <a href="#effective-cost" class="nav-item">
                        <span class="nav-icon">üíé</span>
                        <span>Efektif Maliyet</span>
                    </a>
                    <a href="#risk-matrix" class="nav-item">
                        <span class="nav-icon">üõ°Ô∏è</span>
                        <span>Risk Matrisi</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Faz 7.5 - √ñƒürenme</div>
                    <a href="#market-memory" class="nav-item">
                        <span class="nav-icon">üß†</span>
                        <span>Piyasa Hafƒ±zasƒ±</span>
                    </a>
                    <a href="#pattern-learning" class="nav-item">
                        <span class="nav-icon">üß©</span>
                        <span>Pattern Tanƒ±ma</span>
                    </a>
                    <a href="#auto-adapt" class="nav-item">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span>Otomatik Adaptasyon</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-title">Marketler</div>
                    <a href="#a101" class="nav-item">
                        <span class="nav-icon">üõí</span>
                        <span>A101</span>
                    </a>
                    <a href="#bim" class="nav-item">
                        <span class="nav-icon">üõçÔ∏è</span>
                        <span>Bƒ∞M</span>
                    </a>
                    <a href="#metro" class="nav-item">
                        <span class="nav-icon">üè¢</span>
                        <span>Metro</span>
                    </a>
                    <a href="#migros" class="nav-item">
                        <span class="nav-icon">üè™</span>
                        <span>Migros</span>
                    </a>
                </div>
            </nav>
        </div>

        <!-- Ana Panel -->
        <div class="main-panel">
            <div class="main-header fade-in">
                <h1 class="page-title">üí∞ Maliyet Sim√ºlasyonu v1.0</h1>
                <p class="page-subtitle">Faz 8: Piyasa Trend Zek√¢sƒ± - 30 g√ºnl√ºk fiyat hareket analizi ve mini grafikler</p>
            </div>

            <!-- Recipe Selection Section -->
            <section class="recipe-selection fade-in" id="recipe-selection">
                <div class="section-title">
                    <span>üç≥</span>
                    <span>Tarif Se√ßimi</span>
                </div>

                <div class="recipe-grid">
                    <div class="recipe-card selected" data-recipe="et-sote">
                        <div class="recipe-icon">ü•©</div>
                        <div class="recipe-name">Et Sote</div>
                    </div>
                    <div class="recipe-card" data-recipe="tavuk-kavurma">
                        <div class="recipe-icon">üêî</div>
                        <div class="recipe-name">Tavuk Kavurma</div>
                    </div>
                    <div class="recipe-card" data-recipe="sebze-yemek">
                        <div class="recipe-icon">ü•ï</div>
                        <div class="recipe-name">Sebze Yemeƒüi</div>
                    </div>
                    <div class="recipe-card" data-recipe="pilav">
                        <div class="recipe-icon">üçö</div>
                        <div class="recipe-name">Pilav</div>
                    </div>
                </div>

                <button class="simulate-button" id="simulateBtn">
                    üìä Maliyet Sim√ºlasyonunu Ba≈ülat
                </button>
            </section>

            <!-- 3 Scenario Analysis -->
            <section class="scenario-analysis" id="scenarioAnalysis" style="display: none;">
                <div class="scenario-panel cheapest" data-scenario="cheapest">
                    <div class="scenario-header">
                        <span class="scenario-icon">üí∞</span>
                        <span class="scenario-title">En Ucuz</span>
                        <span class="scenario-badge badge-cheapest">Budget</span>
                    </div>
                    
                    <div class="scenario-metrics" id="cheapestMetrics">
                        <div class="metric-item">
                            <div class="metric-value cost-green" id="cheapestCost">‚Ç∫9,980</div>
                            <div class="metric-label">Toplam Maliyet</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value" id="cheapestQuality">72%</div>
                            <div class="metric-label">Kalite Skoru</div>
                        </div>
                    </div>
                    
                    <div class="scenario-description">
                        Sadece en d√º≈ü√ºk fiyatlƒ± √ºr√ºnler se√ßilir. Risk: Kalite d√º≈üebilir, tazelik kontrol√º sƒ±nƒ±rlƒ±.
                    </div>
                    
                    <div class="scenario-markets" id="cheapestMarkets">
                        <span class="market-tag">üåæ Tarƒ±m Kredi</span>
                        <span class="market-tag">üõçÔ∏è Bƒ∞M</span>
                    </div>
                </div>

                <div class="scenario-panel balanced selected" data-scenario="balanced">
                    <div class="scenario-header">
                        <span class="scenario-icon">‚öñÔ∏è</span>
                        <span class="scenario-title">Denge</span>
                        <span class="scenario-badge badge-balanced">Optimal</span>
                    </div>
                    
                    <div class="scenario-metrics" id="balancedMetrics">
                        <div class="metric-item">
                            <div class="metric-value cost-yellow" id="balancedCost">‚Ç∫10,380</div>
                            <div class="metric-label">Toplam Maliyet</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value" id="balancedQuality">89%</div>
                            <div class="metric-label">Kalite Skoru</div>
                        </div>
                    </div>
                    
                    <div class="scenario-description">
                        Fiyat-kalite dengesi optimize edilir. AI'nin √∂nerdiƒüi en mantƒ±klƒ± kombinasyon.
                    </div>
                    
                    <div class="scenario-markets" id="balancedMarkets">
                        <span class="market-tag">üõçÔ∏è Bƒ∞M</span>
                        <span class="market-tag">üè¢ Metro</span>
                        <span class="market-tag">üõí A101</span>
                    </div>
                </div>

                <div class="scenario-panel premium" data-scenario="premium">
                    <div class="scenario-header">
                        <span class="scenario-icon">üåü</span>
                        <span class="scenario-title">Premium</span>
                        <span class="scenario-badge badge-premium">Quality</span>
                    </div>
                    
                    <div class="scenario-metrics" id="premiumMetrics">
                        <div class="metric-item">
                            <div class="metric-value cost-purple" id="premiumCost">‚Ç∫11,200</div>
                            <div class="metric-label">Toplam Maliyet</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value" id="premiumQuality">95%</div>
                            <div class="metric-label">Kalite Skoru</div>
                        </div>
                    </div>
                    
                    <div class="scenario-description">
                        En y√ºksek kaliteli √ºr√ºnler √∂ncelikli. Maliyet ikinci planda, g√ºvenilirlik maksimum.
                    </div>
                    
                    <div class="scenario-markets" id="premiumMarkets">
                        <span class="market-tag">üè¢ Metro</span>
                        <span class="market-tag">üè™ Migros</span>
                    </div>
                </div>
            </section>

            <!-- Market Research Analysis - Normalized Pricing -->
            <section class="market-research" id="marketResearch">
                <div class="research-header">
                    <div class="section-title">
                        <span>üîç</span>
                        <span>Birim Fiyat Normalize Analizi</span>
                    </div>
                    <div class="research-controls">
                        <button class="control-button active" data-view="normalized">‚Ç∫/kg Kar≈üƒ±la≈ütƒ±rma</button>
                        <button class="control-button" data-view="deviation">Fark Y√ºzdesi</button>
                        <button class="control-button" data-view="reference">Referans Analizi</button>
                    </div>
                </div>

                <!-- Maliyet Kar≈üƒ±la≈ütƒ±rma √ñzeti -->
                <div class="analysis-summary">
                    <div class="summary-card">
                        <div class="summary-value cost-green" id="bestDealValue">10‚Ç∫/kg</div>
                        <div class="summary-label">En D√º≈ü√ºk Birim Fiyat</div>
                        <div class="summary-trend cost-green">Referans fiyat</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value cost-red" id="worstDealValue">20‚Ç∫/kg</div>
                        <div class="summary-label">En Y√ºksek Birim Fiyat</div>
                        <div class="summary-trend cost-red">+100% fark</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value" id="avgPriceValue">15‚Ç∫/kg</div>
                        <div class="summary-label">Ortalama Birim Fiyat</div>
                        <div class="summary-trend">6 market</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value cost-yellow" id="deviationValue">10‚Ç∫</div>
                        <div class="summary-label">Fiyat Fark Aralƒ±ƒüƒ±</div>
                        <div class="summary-trend">‚Ç∫/kg bazƒ±nda</div>
                    </div>
                </div>

                <!-- Normalized Price Table -->
                <table class="normalized-table" id="normalizedTable">
                    <thead>
                        <tr>
                            <th>√úr√ºn</th>
                            <th>Market</th>
                            <th>Ger√ßek Veri</th>
                            <th>Birim Fiyat (‚Ç∫/kg)</th>
                            <th>Referans Farkƒ±</th>
                            <th>Durum</th>
                        </tr>
                    </thead>
                    <tbody id="normalizedTableBody">
                        <!-- Dinamik olarak doldurulacak -->
                    </tbody>
                </table>

                <!-- Maliyet Farkƒ± Analizi -->
                <div class="ai-insights">
                    <div class="insights-header">
                        <span>üìä</span>
                        <span class="insights-title">Birim Fiyat Maliyet Farkƒ±</span>
                    </div>
                    <div class="insights-content" id="priceInsights">
                        <div class="insight-item">
                            <span class="insight-icon">‚Üí</span>
                            <span><strong>En Ucuz:</strong> A101 patates 10‚Ç∫/kg (referans fiyat)</span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">‚Üí</span>
                            <span><strong>En Pahalƒ±:</strong> Bƒ∞M patates 20‚Ç∫/kg (+100% fark)</span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">‚Üí</span>
                            <span><strong>Ortalama:</strong> T√ºm marketler 15‚Ç∫/kg birim fiyat ortalamasƒ±</span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">‚Üí</span>
                            <span><strong>Fark Aralƒ±ƒüƒ±:</strong> En ucuz-pahalƒ± arasƒ± %100 maliyet farkƒ±</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Faz 8: Piyasa Trend Zek√¢sƒ± -->
            <section class="trend-analysis" id="trendAnalysis" style="display: none;">
                <div class="trend-header">
                    <div class="section-title">
                        <span>üìà</span>
                        <span>Piyasa Trend Zek√¢sƒ± (Faz 8)</span>
                    </div>
                    <div class="trend-controls">
                        <button class="trend-button active" data-period="30">Son 30 G√ºn</button>
                        <button class="trend-button" data-period="7">Son 7 G√ºn</button>
                        <button class="trend-button" data-period="1">G√ºnl√ºk</button>
                        <button class="export-button" id="exportTrendBtn">üìÑ PDF Aktar</button>
                    </div>
                </div>

                <!-- Trend √ñzet Kartlarƒ± -->
                <div class="trend-summary">
                    <div class="trend-summary-card">
                        <div class="trend-summary-value trend-up">3</div>
                        <div class="trend-summary-label">Artan √úr√ºn</div>
                        <div class="trend-summary-detail">‚¨ÜÔ∏è Fiyat y√ºkseli≈üi</div>
                    </div>
                    <div class="trend-summary-card">
                        <div class="trend-summary-value trend-down">1</div>
                        <div class="trend-summary-label">D√º≈üen √úr√ºn</div>
                        <div class="trend-summary-detail">‚¨áÔ∏è Fiyat d√º≈ü√º≈ü√º</div>
                    </div>
                    <div class="trend-summary-card">
                        <div class="trend-summary-value cost-yellow">+5.2%</div>
                        <div class="trend-summary-label">Ortalama Deƒüi≈üim</div>
                        <div class="trend-summary-detail">30 g√ºnl√ºk ortalama</div>
                    </div>
                    <div class="trend-summary-card">
                        <div class="trend-summary-value cost-blue">‚Ç∫2.4</div>
                        <div class="trend-summary-label">Maksimum Fark</div>
                        <div class="trend-summary-detail">En y√ºksek deƒüi≈üim</div>
                    </div>
                </div>

                <!-- Trend Analizi Tablosu -->
                <table class="trend-table" id="trendTable">
                    <thead>
                        <tr>
                            <th>√úr√ºn</th>
                            <th>G√ºncel Fiyat (‚Ç∫/kg)</th>
                            <th>1 Ay √ñnce</th>
                            <th>Ortalama Deƒüi≈üim</th>
                            <th>Y√∂n</th>
                            <th>Fark (%)</th>
                            <th>Mini Grafik</th>
                        </tr>
                    </thead>
                    <tbody id="trendTableBody">
                        <tr>
                            <td>ü•î Patates</td>
                            <td class="price-change positive">10.3‚Ç∫</td>
                            <td class="price-change neutral">9.5‚Ç∫</td>
                            <td class="price-change positive">+0.8‚Ç∫</td>
                            <td class="trend-direction">
                                <span class="trend-icon trend-up">‚¨ÜÔ∏è</span>
                                <span>Artƒ±≈ü</span>
                            </td>
                            <td class="price-change positive">+8.4%</td>
                            <td><span class="sparkline">‚ñÑ‚ñÖ‚ñÜ‚ñá‚ñÖ</span></td>
                        </tr>
                        <tr>
                            <td>üßÖ Soƒüan</td>
                            <td class="price-change positive">14.2‚Ç∫</td>
                            <td class="price-change neutral">13.5‚Ç∫</td>
                            <td class="price-change positive">+0.7‚Ç∫</td>
                            <td class="trend-direction">
                                <span class="trend-icon trend-up">‚¨ÜÔ∏è</span>
                                <span>Artƒ±≈ü</span>
                            </td>
                            <td class="price-change positive">+5.2%</td>
                            <td><span class="sparkline">‚ñÉ‚ñÑ‚ñÖ‚ñÜ‚ñá</span></td>
                        </tr>
                        <tr>
                            <td>üçÖ Domates</td>
                            <td class="price-change negative">11.6‚Ç∫</td>
                            <td class="price-change neutral">12.0‚Ç∫</td>
                            <td class="price-change negative">-0.4‚Ç∫</td>
                            <td class="trend-direction">
                                <span class="trend-icon trend-down">‚¨áÔ∏è</span>
                                <span>D√º≈ü√º≈ü</span>
                            </td>
                            <td class="price-change negative">-3.3%</td>
                            <td><span class="sparkline">‚ñá‚ñÜ‚ñÖ‚ñÑ‚ñÉ</span></td>
                        </tr>
                        <tr>
                            <td>ü•© Et</td>
                            <td class="price-change positive">89.5‚Ç∫</td>
                            <td class="price-change neutral">85.0‚Ç∫</td>
                            <td class="price-change positive">+4.5‚Ç∫</td>
                            <td class="trend-direction">
                                <span class="trend-icon trend-up">‚¨ÜÔ∏è</span>
                                <span>Artƒ±≈ü</span>
                            </td>
                            <td class="price-change positive">+5.3%</td>
                            <td><span class="sparkline">‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñá</span></td>
                        </tr>
                        <tr>
                            <td>ü´í Yaƒü</td>
                            <td class="price-change neutral">42.8‚Ç∫</td>
                            <td class="price-change neutral">42.5‚Ç∫</td>
                            <td class="price-change neutral">+0.3‚Ç∫</td>
                            <td class="trend-direction">
                                <span class="trend-icon trend-stable">‚ÜîÔ∏è</span>
                                <span>Sabit</span>
                            </td>
                            <td class="price-change neutral">+0.7%</td>
                            <td><span class="sparkline">‚ñÖ‚ñÖ‚ñÑ‚ñÖ‚ñÖ</span></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Faz 7.3: Karma Kombinasyon AI'ƒ± -->
            <section class="combination-ai" id="combinationAI" style="display: none;">
                <div class="section-title">
                    <span>üß†</span>
                    <span>Karma Kombinasyon AI'ƒ± (Faz 7.3)</span>
                </div>

                <!-- Optimal Combination Summary -->
                <div class="combination-summary">
                    <div class="summary-header">
                        <h3>üéØ En Optimal Market Kombinasyonu</h3>
                        <div class="optimization-score">
                            <span class="score-value" id="optimizationScore">94%</span>
                            <span class="score-label">Optimizasyon Skoru</span>
                        </div>
                    </div>
                    
                    <div class="combination-grid">
                        <div class="ingredient-assignment" data-ingredient="patates">
                            <div class="ingredient-header">
                                <span class="ingredient-icon">ü•î</span>
                                <span class="ingredient-name">Patates</span>
                            </div>
                            <div class="assigned-market">
                                <span class="market-logo">üõí</span>
                                <span class="market-name">A101</span>
                                <span class="assignment-reason">En Ucuz (9.5‚Ç∫/kg)</span>
                            </div>
                            <div class="assignment-metrics">
                                <span class="metric">üí∞ %23 tasarruf</span>
                                <span class="metric">üìç 2.1km mesafe</span>
                            </div>
                        </div>

                        <div class="ingredient-assignment" data-ingredient="sogan">
                            <div class="ingredient-header">
                                <span class="ingredient-icon">üßÖ</span>
                                <span class="ingredient-name">Soƒüan</span>
                            </div>
                            <div class="assigned-market">
                                <span class="market-logo">üè¢</span>
                                <span class="market-name">Metro</span>
                                <span class="assignment-reason">Kalite/Fiyat Dengesi</span>
                            </div>
                            <div class="assignment-metrics">
                                <span class="metric">‚öñÔ∏è %15 denge avantajƒ±</span>
                                <span class="metric">üìç 3.4km mesafe</span>
                            </div>
                        </div>

                        <div class="ingredient-assignment" data-ingredient="et">
                            <div class="ingredient-header">
                                <span class="ingredient-icon">ü•©</span>
                                <span class="ingredient-name">Et</span>
                            </div>
                            <div class="assigned-market">
                                <span class="market-logo">üè™</span>
                                <span class="market-name">Migros</span>
                                <span class="assignment-reason">En Kaliteli</span>
                            </div>
                            <div class="assignment-metrics">
                                <span class="metric">üåü %98 kalite skoru</span>
                                <span class="metric">üìç 1.8km mesafe</span>
                            </div>
                        </div>

                        <div class="ingredient-assignment" data-ingredient="yag">
                            <div class="ingredient-header">
                                <span class="ingredient-icon">ü´í</span>
                                <span class="ingredient-name">Yaƒü</span>
                            </div>
                            <div class="assigned-market">
                                <span class="market-logo">üõçÔ∏è</span>
                                <span class="market-name">Bƒ∞M</span>
                                <span class="assignment-reason">Fiyat Avantajƒ±</span>
                            </div>
                            <div class="assignment-metrics">
                                <span class="metric">üí∞ %18 tasarruf</span>
                                <span class="metric">üìç 1.2km mesafe</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Logic Chain -->
                <div class="ai-logic-chain">
                    <div class="chain-header">
                        <span>ü§ñ</span>
                        <span>AI Karar Mantƒ±ƒüƒ±</span>
                    </div>
                    <div class="logic-steps" id="logicSteps">
                        <div class="logic-step">
                            <span class="step-number">1</span>
                            <div class="step-content">
                                <strong>Patates ‚Üí A101:</strong> 9.5‚Ç∫/kg en d√º≈ü√ºk fiyat, %23 tasarruf saƒülƒ±yor. Kalite skoru yeterli (%78).
                            </div>
                        </div>
                        <div class="logic-step">
                            <span class="step-number">2</span>
                            <div class="step-content">
                                <strong>Soƒüan ‚Üí Metro:</strong> Fiyat/kalite dengesi optimal. 13.8‚Ç∫/kg ile %15 verimlilik artƒ±≈üƒ±.
                            </div>
                        </div>
                        <div class="logic-step">
                            <span class="step-number">3</span>
                            <div class="step-content">
                                <strong>Et ‚Üí Migros:</strong> Kritik √ºr√ºn i√ßin kalite √∂ncelikli. %98 g√ºven skoru ile risk minimized.
                            </div>
                        </div>
                        <div class="logic-step">
                            <span class="step-number">4</span>
                            <div class="step-content">
                                <strong>Lojistik Fakt√∂r:</strong> 4 farklƒ± market, ortalama 2.1km mesafe. Toplam ula≈üƒ±m maliyeti ‚Ç∫12.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Combination Comparison -->
                <div class="combination-comparison">
                    <div class="comparison-header">
                        <span>üìä</span>
                        <span>Kombinasyon Analizi</span>
                    </div>
                    
                    <table class="combination-table">
                        <thead>
                            <tr>
                                <th>Senaryo</th>
                                <th>Toplam Maliyet</th>
                                <th>Kalite Ortalamasƒ±</th>
                                <th>Market Sayƒ±sƒ±</th>
                                <th>Lojistik Maliyet</th>
                                <th>Toplam Avantaj</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="optimal-row">
                                <td><strong>üéØ AI Optimal</strong></td>
                                <td class="cost-value cost-green">‚Ç∫10,240</td>
                                <td>88%</td>
                                <td>4 market</td>
                                <td>‚Ç∫12</td>
                                <td class="advantage-positive">+18%</td>
                            </tr>
                            <tr>
                                <td>üí∞ Tek Market (En Ucuz)</td>
                                <td class="cost-value cost-yellow">‚Ç∫10,980</td>
                                <td>74%</td>
                                <td>1 market</td>
                                <td>‚Ç∫3</td>
                                <td class="advantage-negative">-9%</td>
                            </tr>
                            <tr>
                                <td>üåü Tek Market (Kaliteli)</td>
                                <td class="cost-value cost-red">‚Ç∫11,850</td>
                                <td>95%</td>
                                <td>1 market</td>
                                <td>‚Ç∫3</td>
                                <td class="advantage-negative">-15%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Faz 7.4: Kalite Katsayƒ±sƒ± Entegrasyonu -->
            <section class="quality-integration" id="qualityIntegration" style="display: none;">
                <div class="section-title">
                    <span>‚ö°</span>
                    <span>Kalite Katsayƒ±sƒ± Entegrasyonu (Faz 7.4)</span>
                </div>

                <!-- Efektif Maliyet Hesaplama -->
                <div class="effective-cost-analysis">
                    <div class="analysis-header">
                        <h3>üíé Efektif Maliyet Analizi</h3>
                        <div class="confidence-score">
                            <span class="confidence-value" id="confidenceScore">91%</span>
                            <span class="confidence-label">G√ºven Skoru</span>
                        </div>
                    </div>

                    <div class="cost-breakdown">
                        <div class="breakdown-card">
                            <div class="card-header">
                                <span class="card-icon">üí∞</span>
                                <span class="card-title">Ham Maliyet</span>
                            </div>
                            <div class="cost-details">
                                <div class="primary-cost" id="rawCost">‚Ç∫10,240</div>
                                <div class="cost-description">Temel fiyat hesaplamasƒ±</div>
                            </div>
                        </div>

                        <div class="breakdown-card penalty">
                            <div class="card-header">
                                <span class="card-icon">‚ö†Ô∏è</span>
                                <span class="card-title">Risk Primi</span>
                            </div>
                            <div class="cost-details">
                                <div class="primary-cost risk-cost" id="riskPremium">+‚Ç∫312</div>
                                <div class="cost-description">Kalite d√º≈ü√º≈ü riski</div>
                            </div>
                        </div>

                        <div class="breakdown-card total">
                            <div class="card-header">
                                <span class="card-icon">üéØ</span>
                                <span class="card-title">Efektif Maliyet</span>
                            </div>
                            <div class="cost-details">
                                <div class="primary-cost effective-cost" id="effectiveCost">‚Ç∫10,552</div>
                                <div class="cost-description">Risk ayarlƒ± toplam</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Kalite Risk Matrisi -->
                <div class="quality-risk-matrix">
                    <div class="matrix-header">
                        <span>üìä</span>
                        <span>Kalite Risk Matrisi</span>
                    </div>

                    <table class="risk-matrix-table">
                        <thead>
                            <tr>
                                <th>√úr√ºn</th>
                                <th>Market</th>
                                <th>Ham Fiyat</th>
                                <th>Kalite Skoru</th>
                                <th>Risk Fakt√∂r√º</th>
                                <th>Penaltƒ±</th>
                                <th>Efektif Fiyat</th>
                            </tr>
                        </thead>
                        <tbody id="riskMatrixBody">
                            <tr class="risk-low">
                                <td>ü•î Patates</td>
                                <td>üõí A101</td>
                                <td>‚Ç∫9.5/kg</td>
                                <td><span class="quality-score">78%</span></td>
                                <td class="risk-factor risk-low">D√º≈ü√ºk</td>
                                <td>+‚Ç∫0.8/kg</td>
                                <td class="effective-price">‚Ç∫10.3/kg</td>
                            </tr>
                            <tr class="risk-low">
                                <td>üßÖ Soƒüan</td>
                                <td>üè¢ Metro</td>
                                <td>‚Ç∫13.8/kg</td>
                                <td><span class="quality-score">85%</span></td>
                                <td class="risk-factor risk-low">D√º≈ü√ºk</td>
                                <td>+‚Ç∫0.4/kg</td>
                                <td class="effective-price">‚Ç∫14.2/kg</td>
                            </tr>
                            <tr class="risk-very-low">
                                <td>ü•© Et</td>
                                <td>üè™ Migros</td>
                                <td>‚Ç∫87.0/kg</td>
                                <td><span class="quality-score">98%</span></td>
                                <td class="risk-factor risk-very-low">√áok D√º≈ü√ºk</td>
                                <td>+‚Ç∫0.5/kg</td>
                                <td class="effective-price">‚Ç∫87.5/kg</td>
                            </tr>
                            <tr class="risk-medium">
                                <td>ü´í Yaƒü</td>
                                <td>üõçÔ∏è Bƒ∞M</td>
                                <td>‚Ç∫41.5/kg</td>
                                <td><span class="quality-score">82%</span></td>
                                <td class="risk-factor risk-medium">Orta</td>
                                <td>+‚Ç∫1.8/kg</td>
                                <td class="effective-price">‚Ç∫43.3/kg</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- G√ºven Skoru Detaylarƒ± -->
                <div class="confidence-details">
                    <div class="details-header">
                        <span>üõ°Ô∏è</span>
                        <span>G√ºven Skoru Analizi</span>
                    </div>

                    <div class="confidence-metrics">
                        <div class="metric-card">
                            <div class="metric-icon">üìà</div>
                            <div class="metric-content">
                                <div class="metric-value">94%</div>
                                <div class="metric-label">Kalite G√ºvenilirliƒüi</div>
                                <div class="metric-detail">Market reputasyon skoru</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">‚è±Ô∏è</div>
                            <div class="metric-content">
                                <div class="metric-value">89%</div>
                                <div class="metric-label">Tazelik Consistency</div>
                                <div class="metric-detail">Son 3 ay ortalamasƒ±</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">üéØ</div>
                            <div class="metric-content">
                                <div class="metric-value">91%</div>
                                <div class="metric-label">Genel G√ºven</div>
                                <div class="metric-detail">Aƒüƒ±rlƒ±klƒ± ortalama</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">üí°</div>
                            <div class="metric-content">
                                <div class="metric-value">+3.0%</div>
                                <div class="metric-label">Risk Primi</div>
                                <div class="metric-detail">Ortalama penaltƒ± oranƒ±</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Faz 7.5: Piyasa Hafƒ±zasƒ± √ñƒürenme -->
            <section class="market-memory" id="marketMemory" style="display: none;">
                <div class="section-title">
                    <span>üß†</span>
                    <span>Piyasa Hafƒ±zasƒ± √ñƒürenme (Faz 7.5)</span>
                </div>

                <!-- √ñƒürenme Durumu -->
                <div class="learning-status">
                    <div class="status-header">
                        <h3>üîÑ Sistem √ñƒürenme Durumu</h3>
                        <div class="learning-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="learningProgress" style="width: 73%"></div>
                            </div>
                            <span class="progress-text" id="learningText">73% √ñƒürenme</span>
                        </div>
                    </div>

                    <div class="learning-metrics">
                        <div class="metric-box">
                            <div class="metric-icon">üìä</div>
                            <div class="metric-info">
                                <div class="metric-number" id="dataPoints">1,247</div>
                                <div class="metric-label">Veri Noktasƒ±</div>
                            </div>
                        </div>

                        <div class="metric-box">
                            <div class="metric-icon">‚è±Ô∏è</div>
                            <div class="metric-info">
                                <div class="metric-number" id="learningDays">89</div>
                                <div class="metric-label">√ñƒürenme G√ºn√º</div>
                            </div>
                        </div>

                        <div class="metric-box">
                            <div class="metric-icon">üéØ</div>
                            <div class="metric-info">
                                <div class="metric-number" id="accuracyRate">91.3%</div>
                                <div class="metric-label">Tahmin Doƒüruluƒüu</div>
                            </div>
                        </div>

                        <div class="metric-box">
                            <div class="metric-icon">üîÑ</div>
                            <div class="metric-info">
                                <div class="metric-number" id="adaptationCycle">v2.8</div>
                                <div class="metric-label">Adaptasyon S√ºr√ºm√º</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pattern Tanƒ±ma -->
                <div class="pattern-recognition">
                    <div class="pattern-header">
                        <span>üß©</span>
                        <span>Davranƒ±≈ü Pattern Analizi</span>
                    </div>

                    <div class="pattern-grid">
                        <div class="pattern-card detected">
                            <div class="pattern-title">
                                <span class="pattern-icon">üìà</span>
                                <span>Fiyat Korelasyonu</span>
                                <span class="detection-badge">Tespit Edildi</span>
                            </div>
                            <div class="pattern-details">
                                <div class="pattern-insight">Et fiyatƒ± ile yaƒü fiyatƒ± arasƒ±nda %78 korelasyon tespit edildi</div>
                                <div class="pattern-confidence">G√ºven: 94%</div>
                            </div>
                        </div>

                        <div class="pattern-card detected">
                            <div class="pattern-title">
                                <span class="pattern-icon">üìÖ</span>
                                <span>Sezonsal D√∂ng√º</span>
                                <span class="detection-badge">Tespit Edildi</span>
                            </div>
                            <div class="pattern-details">
                                <div class="pattern-insight">Sebze fiyatlarƒ± her 15 g√ºnde %12 d√º≈ü√º≈ü trendi g√∂steriyor</div>
                                <div class="pattern-confidence">G√ºven: 87%</div>
                            </div>
                        </div>

                        <div class="pattern-card learning">
                            <div class="pattern-title">
                                <span class="pattern-icon">üè™</span>
                                <span>Market Davranƒ±≈üƒ±</span>
                                <span class="detection-badge learning">√ñƒüreniyor</span>
                            </div>
                            <div class="pattern-details">
                                <div class="pattern-insight">Migros premium fiyatlandƒ±rmasƒ± pattern analizi devam ediyor</div>
                                <div class="pattern-confidence">G√ºven: 62%</div>
                            </div>
                        </div>

                        <div class="pattern-card pending">
                            <div class="pattern-title">
                                <span class="pattern-icon">‚ö°</span>
                                <span>Ani Deƒüi≈üim</span>
                                <span class="detection-badge pending">Beklemede</span>
                            </div>
                            <div class="pattern-details">
                                <div class="pattern-insight">Makroekonomik ≈üoklarƒ±n fiyat etkisi hen√ºz yeterli veri yok</div>
                                <div class="pattern-confidence">G√ºven: 31%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Otomatik Katsayƒ± Ayarlama -->
                <div class="auto-coefficients">
                    <div class="coefficients-header">
                        <span>‚öôÔ∏è</span>
                        <span>Otomatik Aƒüƒ±rlƒ±k Katsayƒ±sƒ± Ayarlama</span>
                    </div>

                    <table class="coefficients-table">
                        <thead>
                            <tr>
                                <th>Fakt√∂r</th>
                                <th>Ba≈ülangƒ±√ß Aƒüƒ±rlƒ±ƒüƒ±</th>
                                <th>Mevcut Aƒüƒ±rlƒ±k</th>
                                <th>Deƒüi≈üim</th>
                                <th>√ñƒürenme Etkisi</th>
                                <th>Son G√ºncelleme</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="coefficient-positive">
                                <td>üí∞ Fiyat √ñnceliƒüi</td>
                                <td>0.45</td>
                                <td class="current-weight">0.52</td>
                                <td class="weight-change positive">+0.07</td>
                                <td>Kullanƒ±cƒ± davranƒ±≈üƒ±ndan √∂ƒürenildi</td>
                                <td>2 saat √∂nce</td>
                            </tr>
                            <tr class="coefficient-negative">
                                <td>üåü Kalite √ñnceliƒüi</td>
                                <td>0.35</td>
                                <td class="current-weight">0.28</td>
                                <td class="weight-change negative">-0.07</td>
                                <td>Se√ßim pattern'inden d√º≈üt√º</td>
                                <td>2 saat √∂nce</td>
                            </tr>
                            <tr class="coefficient-stable">
                                <td>üìç Mesafe Fakt√∂r√º</td>
                                <td>0.20</td>
                                <td class="current-weight">0.20</td>
                                <td class="weight-change stable">¬±0.00</td>
                                <td>Stabil davranƒ±≈ü</td>
                                <td>5 g√ºn √∂nce</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- √ñƒürenme Ge√ßmi≈üi -->
                <div class="learning-history">
                    <div class="history-header">
                        <span>üìö</span>
                        <span>√ñƒürenme Ge√ßmi≈üi</span>
                    </div>

                    <div class="history-timeline">
                        <div class="timeline-item recent">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Fiyat √ñnceliƒüi Artƒ±rƒ±ldƒ±</div>
                                <div class="timeline-details">Kullanƒ±cƒ± 5 defa ucuz se√ßeneƒüi tercih etti ‚Üí Aƒüƒ±rlƒ±k +0.07</div>
                                <div class="timeline-time">2 saat √∂nce</div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Sezonsal Pattern Ke≈üfedildi</div>
                                <div class="timeline-details">Sebze fiyatlarƒ± 15 g√ºnl√ºk d√∂ng√º tespit edildi</div>
                                <div class="timeline-time">1 g√ºn √∂nce</div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Market Korelasyonu √ñƒürenildi</div>
                                <div class="timeline-details">Et-yaƒü fiyat korelasyonu %78 tespit edildi</div>
                                <div class="timeline-time">3 g√ºn √∂nce</div>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <div class="timeline-title">Sistem v2.8 G√ºncellendi</div>
                                <div class="timeline-details">Yeni √∂ƒürenme algoritmasƒ± devreye alƒ±ndƒ±</div>
                                <div class="timeline-time">1 hafta √∂nce</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Scenario Comparison -->
            <section class="scenario-comparison" id="scenarioComparison">
                <div class="section-title">
                    <span>üìä</span>
                    <span>Senaryo Kar≈üƒ±la≈ütƒ±rmasƒ±</span>
                </div>

                <div class="comparison-grid" id="comparisonGrid">
                    <div class="comparison-card" id="cheapestCard">
                        <div class="comparison-title">üí∞ En Ucuz Senaryo</div>
                        <div class="comparison-cost cost-green">‚Ç∫9,980</div>
                        <div class="comparison-details">
                            Kalite: 72%<br>
                            Risk: Orta<br>
                            Tazelik: Sƒ±nƒ±rlƒ±
                        </div>
                    </div>
                    
                    <div class="comparison-card winner" id="balancedCard">
                        <div class="comparison-title">‚öñÔ∏è Denge Senaryo</div>
                        <div class="comparison-cost cost-yellow">‚Ç∫10,380</div>
                        <div class="comparison-details">
                            Kalite: 89%<br>
                            Risk: D√º≈ü√ºk<br>
                            Tazelik: Y√ºksek
                        </div>
                    </div>
                    
                    <div class="comparison-card" id="premiumCard">
                        <div class="comparison-title">üåü Premium Senaryo</div>
                        <div class="comparison-cost cost-purple">‚Ç∫11,200</div>
                        <div class="comparison-details">
                            Kalite: 95%<br>
                            Risk: √áok D√º≈ü√ºk<br>
                            Tazelik: Maksimum
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI Scenario Recommendation -->
            <section class="scenario-recommendation" id="scenarioRecommendation" style="display: none;">
                <div class="recommendation-scenario">
                    <span>ü§ñ</span>
                    <span class="recommendation-title">AI Senaryo √ñnerisi</span>
                    <span class="recommended-badge">√ñnerilen: Denge</span>
                </div>
                
                <div class="recommendation-content" id="scenarioRecommendationContent">
                    <strong>üìä 3 Senaryo Analizi Tamamlandƒ±</strong><br><br>
                    <strong>AI √ñnerisi:</strong> Denge Senaryosu en mantƒ±klƒ± se√ßim.<br>
                    <strong>Sebep:</strong> %12 maliyet artƒ±≈üƒ±yla %23 kalite artƒ±≈üƒ± saƒülanƒ±yor.<br>
                    <strong>Risk/Fayda:</strong> D√º≈ü√ºk risk, y√ºksek memnuniyet potansiyeli.<br><br>
                    <strong>Alternatif:</strong> B√ºt√ße kƒ±sƒ±tlƒ± ise "En Ucuz" senaryo da kabul edilebilir seviyede.
                </div>

                <div class="thinking-chain">
                    <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                        üß† AI'nin Senaryo Kar≈üƒ±la≈ütƒ±rma S√ºreci:
                    </div>
                    <div id="scenarioThinkingChain">
                        <div class="thinking-step">
                            <span class="step-icon">‚Üí</span>
                            <span>"En ucuz senaryo riskli, Tarƒ±m Kredi verisi eski"</span>
                        </div>
                        <div class="thinking-step">
                            <span class="step-icon">‚Üí</span>
                            <span>"Premium senaryo kaliteli ama %15 fazla maliyet"</span>
                        </div>
                        <div class="thinking-step">
                            <span class="step-icon">‚Üí</span>
                            <span>"Denge senaryosu Bƒ∞M+Metro karƒ±≈üƒ±mƒ± g√ºvenilir"</span>
                        </div>
                        <div class="thinking-step">
                            <span class="step-icon">‚Üí</span>
                            <span>"Maliyet artƒ±≈üƒ± makul, kalite artƒ±≈üƒ± deƒüerli"</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Market Comparison Table -->
            <section class="market-comparison" id="marketComparison">
                <div class="section-title">
                    <span>üè™</span>
                    <span>Market Kar≈üƒ±la≈ütƒ±rmasƒ±</span>
                </div>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Market</th>
                            <th>Toplam (‚Ç∫)</th>
                            <th>Kalite</th>
                            <th>Tazelik</th>
                            <th>Kombinasyon Uygunluƒüu</th>
                            <th>Sonu√ß</th>
                        </tr>
                    </thead>
                    <tbody id="comparisonTableBody">
                        <!-- Dinamik olarak doldurulacak -->
                    </tbody>
                </table>
            </section>

            <!-- AI Recommendation -->
            <section class="ai-recommendation" id="aiRecommendation" style="display: none;">
                <div class="recommendation-header">
                    <span>ü§ñ</span>
                    <span class="recommendation-title">AI Mantƒ±k Deƒüerlendirmesi</span>
                </div>
                
                <div class="recommendation-content" id="recommendationContent">
                    <!-- AI √∂nerisi buraya gelecek -->
                </div>

                <div class="thinking-chain">
                    <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                        üß† AI'nin D√º≈ü√ºnce S√ºreci:
                    </div>
                    <div id="thinkingChain">
                        <!-- AI d√º≈ü√ºnce adƒ±mlarƒ± buraya gelecek -->
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        class CostSimulationSystem {
            constructor() {
                this.selectedRecipe = 'et-sote';
                this.marketData = this.initializeMarketData();
                this.setupEventListeners();
                this.showWelcomeMessage();
            }

            initializeMarketData() {
                return {
                    'et-sote': {
                        name: 'Et Sote',
                        ingredients: ['Et', 'Soƒüan', 'Yaƒü', 'Baharat', 'Tuz'],
                        markets: {
                            'A101': { total: 10420, quality: 0.84, freshness: 'G√ºncel', suitability: 92 },
                            'Bƒ∞M': { total: 10150, quality: 0.79, freshness: 'Eski', suitability: 87 },
                            '≈ûOK': { total: 10380, quality: 0.82, freshness: 'G√ºncel', suitability: 89 },
                            'Metro': { total: 11200, quality: 0.95, freshness: 'G√ºncel', suitability: 96 },
                            'Migros': { total: 10890, quality: 0.91, freshness: 'G√ºncel', suitability: 94 },
                            'Tarƒ±m Kredi': { total: 9980, quality: 0.72, freshness: 'G√ºncelliƒüi d√º≈ü√ºk', suitability: 80 }
                        },
                        // Birim fiyat normalize verisi
                        normalizedPrices: {
                            'Patates': {
                                'A101': { packagePrice: 30, quantity: '3 kg', unitPrice: 10, date: '15 Ekim', freshness: 'G√ºncel' },
                                'Bƒ∞M': { packagePrice: 100, quantity: '5 kg', unitPrice: 20, date: '17 Ekim', freshness: 'Eski' },
                                '≈ûOK': { packagePrice: 45, quantity: '3 kg', unitPrice: 15, date: '16 Ekim', freshness: 'G√ºncel' },
                                'Metro': { packagePrice: 140, quantity: '10 kg', unitPrice: 14, date: '16 Ekim', freshness: 'G√ºncel' },
                                'Migros': { packagePrice: 72, quantity: '4 kg', unitPrice: 18, date: '17 Ekim', freshness: 'G√ºncel' },
                                'Tarƒ±m Kredi': { packagePrice: 80, quantity: '8 kg', unitPrice: 10, date: '10 Ekim', freshness: 'Eski' }
                            },
                            'Soƒüan': {
                                'A101': { packagePrice: 20, quantity: '2 kg', unitPrice: 10, date: '15 Ekim', freshness: 'G√ºncel' },
                                'Bƒ∞M': { packagePrice: 32, quantity: '2 kg', unitPrice: 16, date: '14 Ekim', freshness: 'Eski' },
                                '≈ûOK': { packagePrice: 35, quantity: '2.5 kg', unitPrice: 14, date: '16 Ekim', freshness: 'G√ºncel' },
                                'Metro': { packagePrice: 140, quantity: '10 kg', unitPrice: 14, date: '16 Ekim', freshness: 'G√ºncel' },
                                'Migros': { packagePrice: 45, quantity: '3 kg', unitPrice: 15, date: '17 Ekim', freshness: 'G√ºncel' },
                                'Tarƒ±m Kredi': { packagePrice: 48, quantity: '4 kg', unitPrice: 12, date: '12 Ekim', freshness: 'Orta' }
                            },
                            'Et': {
                                'A101': { packagePrice: 280, quantity: '1 kg', unitPrice: 280, date: '17 Ekim', freshness: 'G√ºncel' },
                                'Bƒ∞M': { packagePrice: 250, quantity: '1 kg', unitPrice: 250, date: '16 Ekim', freshness: 'G√ºncel' },
                                '≈ûOK': { packagePrice: 270, quantity: '1 kg', unitPrice: 270, date: '17 Ekim', freshness: 'G√ºncel' },
                                'Metro': { packagePrice: 320, quantity: '1 kg', unitPrice: 320, date: '17 Ekim', freshness: 'G√ºncel' },
                                'Migros': { packagePrice: 300, quantity: '1 kg', unitPrice: 300, date: '17 Ekim', freshness: 'G√ºncel' },
                                'Tarƒ±m Kredi': { packagePrice: 240, quantity: '1 kg', unitPrice: 240, date: '14 Ekim', freshness: 'Orta' }
                            }
                        }
                    }
                    // Diƒüer tarifler i√ßin benzer veri yapƒ±sƒ±
                };
            }

            setupEventListeners() {
                // Recipe selection
                document.querySelectorAll('.recipe-card').forEach(card => {
                    card.addEventListener('click', () => {
                        this.selectRecipe(card.dataset.recipe);
                    });
                });

                // Simulate button
                document.getElementById('simulateBtn').addEventListener('click', () => {
                    this.runSimulation();
                });

                // Scenario selection
                document.querySelectorAll('.scenario-panel').forEach(panel => {
                    panel.addEventListener('click', () => {
                        this.selectScenario(panel.dataset.scenario);
                    });
                });

                // Research control buttons
                document.querySelectorAll('.control-button').forEach(button => {
                    button.addEventListener('click', () => {
                        this.switchResearchView(button.dataset.view);
                    });
                });
            }

            selectRecipe(recipeId) {
                document.querySelectorAll('.recipe-card').forEach(card => {
                    card.classList.remove('selected');
                });
                document.querySelector(`[data-recipe="${recipeId}"]`).classList.add('selected');
                
                this.selectedRecipe = recipeId;
                console.log(`üçΩÔ∏è Se√ßilen tarif: ${recipeId}`);
            }

            async runSimulation() {
                console.log('üí∞ Maliyet sim√ºlasyonu ba≈ülatƒ±lƒ±yor...');
                
                const btn = document.getElementById('simulateBtn');
                btn.textContent = '‚è≥ AI Hesaplƒ±yor...';
                btn.disabled = true;
                btn.classList.add('processing');

                // Simulate thinking process
                await this.simulateAIThinking();

                // Generate normalized price analysis
                this.generateNormalizedAnalysis();
                
                // Generate 3 scenarios
                this.generateScenarios();
                
                // Generate comparison table
                this.generateComparisonTable();
                
                // Generate AI recommendation
                this.generateAIRecommendation();

                // Show results
                document.getElementById('marketResearch').classList.add('show');
                document.getElementById('scenarioAnalysis').style.display = 'grid';
                document.getElementById('scenarioComparison').classList.add('show');
                document.getElementById('scenarioRecommendation').style.display = 'block';
                document.getElementById('marketComparison').classList.add('show');
                document.getElementById('aiRecommendation').style.display = 'block';

                // Reset button
                btn.textContent = 'üìä Maliyet Sim√ºlasyonunu Ba≈ülat';
                btn.disabled = false;
                btn.classList.remove('processing');

                // Initialize Faz 8: Trend Analysis after 3 seconds
                setTimeout(() => {
                    this.initializeTrendAnalysis();
                }, 3000);

                // Initialize Faz 7.3: Combination AI after 5 seconds
                setTimeout(() => {
                    this.initializeCombinationAI();
                }, 5000);

                // Initialize Faz 7.4: Quality Integration after 7 seconds
                setTimeout(() => {
                    this.initializeQualityIntegration();
                }, 7000);

                // Initialize Faz 7.5: Market Memory after 9 seconds
                setTimeout(() => {
                    this.initializeMarketMemory();
                }, 9000);

                console.log('‚úÖ Sim√ºlasyon tamamlandƒ±');
            }

            async simulateAIThinking() {
                const steps = [
                    'Market fiyat verilerini √ßekiyor...',
                    '3 senaryo hesaplamasƒ± yapƒ±yor...',
                    'Kalite skorlarƒ±nƒ± hesaplƒ±yor...',
                    'Kombinasyon analizini yapƒ±yor...',
                    'AI √∂nerisi hazƒ±rlanƒ±yor...'
                ];

                for (let step of steps) {
                    console.log(`ü§î ${step}`);
                    await new Promise(resolve => setTimeout(resolve, 700));
                }
            }

            generateScenarios() {
                const recipeData = this.marketData[this.selectedRecipe];
                const markets = recipeData.markets;
                
                // Calculate 3 scenarios
                const scenarios = this.calculateScenarios(markets);
                
                // Update scenario panels
                this.updateScenarioPanel('cheapest', scenarios.cheapest);
                this.updateScenarioPanel('balanced', scenarios.balanced);
                this.updateScenarioPanel('premium', scenarios.premium);
                
                // Update comparison cards
                this.updateComparisonCards(scenarios);
            }

            calculateScenarios(markets) {
                const marketEntries = Object.entries(markets);
                
                // 1. En Ucuz Senaryo - Sadece en d√º≈ü√ºk fiyatlarƒ± al
                const cheapest = marketEntries.reduce((min, current) => 
                    current[1].total < min[1].total ? current : min
                );
                
                // 2. Premium Senaryo - En y√ºksek kaliteyi al
                const premium = marketEntries.reduce((max, current) => 
                    current[1].quality > max[1].quality ? current : max
                );
                
                // 3. Denge Senaryo - Kalite*Uygunluk/Maliyet optimizasyonu
                const balanced = marketEntries.reduce((best, current) => {
                    const currentScore = (current[1].quality * current[1].suitability) / (current[1].total / 10000);
                    const bestScore = (best[1].quality * best[1].suitability) / (best[1].total / 10000);
                    return currentScore > bestScore ? current : best;
                });
                
                return {
                    cheapest: {
                        market: cheapest[0],
                        cost: cheapest[1].total,
                        quality: cheapest[1].quality,
                        markets: [cheapest[0]]
                    },
                    balanced: {
                        market: balanced[0],
                        cost: balanced[1].total,
                        quality: balanced[1].quality,
                        markets: [balanced[0], 'A101'] // Karma kombinasyon sim√ºlasyonu
                    },
                    premium: {
                        market: premium[0],
                        cost: premium[1].total,
                        quality: premium[1].quality,
                        markets: [premium[0]]
                    }
                };
            }

            updateScenarioPanel(scenarioType, data) {
                document.getElementById(`${scenarioType}Cost`).textContent = `‚Ç∫${data.cost.toLocaleString()}`;
                document.getElementById(`${scenarioType}Quality`).textContent = `${(data.quality * 100).toFixed(0)}%`;
                
                const marketsContainer = document.getElementById(`${scenarioType}Markets`);
                marketsContainer.innerHTML = '';
                data.markets.forEach(market => {
                    const tag = document.createElement('span');
                    tag.className = 'market-tag';
                    tag.innerHTML = `${this.getMarketLogo(market)} ${market}`;
                    marketsContainer.appendChild(tag);
                });
            }

            updateComparisonCards(scenarios) {
                // En ucuz
                document.querySelector('#cheapestCard .comparison-cost').textContent = `‚Ç∫${scenarios.cheapest.cost.toLocaleString()}`;
                document.querySelector('#cheapestCard .comparison-details').innerHTML = `
                    Kalite: ${(scenarios.cheapest.quality * 100).toFixed(0)}%<br>
                    Risk: ${scenarios.cheapest.quality < 0.8 ? 'Y√ºksek' : 'Orta'}<br>
                    Tazelik: Sƒ±nƒ±rlƒ±
                `;
                
                // Denge
                document.querySelector('#balancedCard .comparison-cost').textContent = `‚Ç∫${scenarios.balanced.cost.toLocaleString()}`;
                document.querySelector('#balancedCard .comparison-details').innerHTML = `
                    Kalite: ${(scenarios.balanced.quality * 100).toFixed(0)}%<br>
                    Risk: D√º≈ü√ºk<br>
                    Tazelik: Y√ºksek
                `;
                
                // Premium
                document.querySelector('#premiumCard .comparison-cost').textContent = `‚Ç∫${scenarios.premium.cost.toLocaleString()}`;
                document.querySelector('#premiumCard .comparison-details').innerHTML = `
                    Kalite: ${(scenarios.premium.quality * 100).toFixed(0)}%<br>
                    Risk: √áok D√º≈ü√ºk<br>
                    Tazelik: Maksimum
                `;
            }

            selectScenario(scenarioType) {
                document.querySelectorAll('.scenario-panel').forEach(panel => {
                    panel.classList.remove('selected');
                });
                document.querySelector(`[data-scenario="${scenarioType}"]`).classList.add('selected');
                
                console.log(`üìä Se√ßilen senaryo: ${scenarioType}`);
                this.updateScenarioRecommendation(scenarioType);
            }

            updateScenarioRecommendation(selectedScenario) {
                const recommendations = {
                    cheapest: {
                        title: 'En Ucuz Senaryo Se√ßildi',
                        badge: 'Budget √ñncelikli',
                        content: 'Maliyet minimize edildi. Kalite ve tazelik kontrol√ºne √∂zen g√∂sterilmesi √∂nerilir.'
                    },
                    balanced: {
                        title: 'Denge Senaryo Se√ßildi',
                        badge: 'AI √ñnerisi',
                        content: 'Optimal fiyat-kalite dengesi saƒülandƒ±. En mantƒ±klƒ± se√ßim olarak deƒüerlendiriliyor.'
                    },
                    premium: {
                        title: 'Premium Senaryo Se√ßildi',
                        badge: 'Kalite √ñncelikli',
                        content: 'Maksimum kalite saƒülandƒ±. Maliyet y√ºksek ama risk minimum seviyede.'
                    }
                };

                const rec = recommendations[selectedScenario];
                document.querySelector('.recommended-badge').textContent = rec.badge;
                document.getElementById('scenarioRecommendationContent').innerHTML = `
                    <strong>üìä ${rec.title}</strong><br><br>
                    ${rec.content}<br><br>
                    <strong>Sonu√ß:</strong> Se√ßimiunuz sistem tarafƒ±ndan kaydedildi ve analiz raporuna dahil edilecek.
                `;
            }

            generateNormalizedAnalysis() {
                const recipeData = this.marketData[this.selectedRecipe];
                const normalizedData = recipeData.normalizedPrices;
                
                // Calculate analysis summary
                this.updateAnalysisSummary(normalizedData);
                
                // Generate normalized table
                this.generateNormalizedTable(normalizedData);
                
                // Update AI insights
                this.updatePriceInsights(normalizedData);
            }

            updateAnalysisSummary(normalizedData) {
                // Sadece birim fiyat kar≈üƒ±la≈ütƒ±rmasƒ±
                let allPrices = [];

                Object.values(normalizedData).forEach(productData => {
                    Object.values(productData).forEach(data => {
                        allPrices.push(data.unitPrice);
                    });
                });

                const avgPrice = allPrices.reduce((a, b) => a + b, 0) / allPrices.length;
                const minPrice = Math.min(...allPrices);
                const maxPrice = Math.max(...allPrices);
                const priceRange = maxPrice - minPrice;

                // Maliyet kar≈üƒ±la≈ütƒ±rma √∂zeti g√ºncelle
                document.getElementById('bestDealValue').textContent = `${minPrice}‚Ç∫/kg`;
                document.getElementById('worstDealValue').textContent = `${maxPrice}‚Ç∫/kg`;
                document.getElementById('avgPriceValue').textContent = `${avgPrice.toFixed(0)}‚Ç∫/kg`;
                document.getElementById('deviationValue').textContent = `${priceRange}‚Ç∫`;
            }

            generateNormalizedTable(normalizedData) {
                const tbody = document.getElementById('normalizedTableBody');
                tbody.innerHTML = '';

                Object.entries(normalizedData).forEach(([product, marketData]) => {
                    const prices = Object.values(marketData).map(d => d.unitPrice);
                    const minPrice = Math.min(...prices); // En ucuz fiyat referans

                    Object.entries(marketData).forEach(([market, data]) => {
                        const row = document.createElement('tr');
                        
                        // √úr√ºn
                        const productCell = document.createElement('td');
                        productCell.innerHTML = `${this.getProductIcon(product)} ${product}`;
                        
                        // Market
                        const marketCell = document.createElement('td');
                        marketCell.innerHTML = `${this.getMarketLogo(market)} ${market}`;
                        
                        // Ger√ßek Veri (Sol S√ºtun)
                        const realDataCell = document.createElement('td');
                        realDataCell.innerHTML = `‚Ç∫${data.packagePrice} / ${data.quantity}`;
                        
                        // Birim Fiyat (Saƒü S√ºtun)
                        const unitPriceCell = document.createElement('td');
                        unitPriceCell.innerHTML = `<span class="price-normalized">‚Ç∫${data.unitPrice}/kg</span>`;
                        
                        // Referans Farkƒ± (En ucuza g√∂re)
                        const priceDiff = ((data.unitPrice - minPrice) / minPrice * 100);
                        const diffCell = document.createElement('td');
                        const diffClass = priceDiff === 0 ? 'deviation-negative' : 
                                         priceDiff > 50 ? 'deviation-positive' : 'deviation-neutral';
                        diffCell.innerHTML = `<span class="${diffClass}">${priceDiff === 0 ? 'Referans' : '+' + priceDiff.toFixed(0) + '%'}</span>`;
                        
                        // Durum
                        const statusCell = document.createElement('td');
                        const statusIcon = priceDiff === 0 ? 'üü¢' : priceDiff > 50 ? 'üî¥' : 'üü°';
                        const statusText = priceDiff === 0 ? 'En Ucuz' : priceDiff > 50 ? 'Pahalƒ±' : 'Orta';
                        statusCell.innerHTML = `<span class="status-icon">${statusIcon}</span>${statusText}`;
                        
                        row.appendChild(productCell);
                        row.appendChild(marketCell);
                        row.appendChild(realDataCell);
                        row.appendChild(unitPriceCell);
                        row.appendChild(diffCell);
                        row.appendChild(statusCell);
                        
                        tbody.appendChild(row);
                    });
                });
            }

            updatePriceInsights(normalizedData) {
                // Generate dynamic insights based on data
                const insights = this.generateAIPriceInsights(normalizedData);
                
                const insightsContainer = document.getElementById('priceInsights');
                insightsContainer.innerHTML = '';
                
                insights.forEach(insight => {
                    const insightDiv = document.createElement('div');
                    insightDiv.className = 'insight-item';
                    insightDiv.innerHTML = `
                        <span class="insight-icon">‚Üí</span>
                        <span>${insight}</span>
                    `;
                    insightsContainer.appendChild(insightDiv);
                });
            }

            generateAIPriceInsights(normalizedData) {
                const insights = [];
                
                // Sadece maliyet farkƒ± hesaplama
                const potatoPrices = normalizedData['Patates'];
                const cheapestPotato = Object.entries(potatoPrices).reduce((a, b) => a[1].unitPrice < b[1].unitPrice ? a : b);
                const expensivePotato = Object.entries(potatoPrices).reduce((a, b) => a[1].unitPrice > b[1].unitPrice ? a : b);
                
                const priceDiff = ((expensivePotato[1].unitPrice - cheapestPotato[1].unitPrice) / cheapestPotato[1].unitPrice * 100).toFixed(0);
                insights.push(`<strong>En Ucuz:</strong> ${cheapestPotato[0]} patates ${cheapestPotato[1].unitPrice}‚Ç∫/kg (referans fiyat)`);
                
                insights.push(`<strong>En Pahalƒ±:</strong> ${expensivePotato[0]} patates ${expensivePotato[1].unitPrice}‚Ç∫/kg (+${priceDiff}% fark)`);
                
                // Ortalama fiyat
                const allPrices = Object.values(potatoPrices).map(d => d.unitPrice);
                const avgPrice = (allPrices.reduce((a, b) => a + b, 0) / allPrices.length).toFixed(0);
                insights.push(`<strong>Ortalama:</strong> T√ºm marketler ${avgPrice}‚Ç∫/kg birim fiyat ortalamasƒ±`);
                
                // Fark aralƒ±ƒüƒ±
                insights.push(`<strong>Fark Aralƒ±ƒüƒ±:</strong> En ucuz-pahalƒ± arasƒ± %${priceDiff} maliyet farkƒ±`);
                
                return insights;
            }

            switchResearchView(viewType) {
                document.querySelectorAll('.control-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-view="${viewType}"]`).classList.add('active');
                
                console.log(`üîç Ara≈ütƒ±rma g√∂r√ºn√ºm√º: ${viewType}`);
                
                // View specific logic can be added here
                if (viewType === 'deviation') {
                    this.highlightDeviations();
                } else if (viewType === 'freshness') {
                    this.highlightFreshness();
                }
            }

            // Faz 8: Piyasa Trend Zek√¢sƒ± Methods
            initializeTrendAnalysis() {
                // Generate historical price data for trends
                this.generateHistoricalData();
                
                // Setup trend controls
                this.setupTrendControls();
                
                // Show trend analysis
                document.getElementById('trendAnalysis').style.display = 'block';
                console.log('üìà Faz 8: Piyasa Trend Zek√¢sƒ± aktifle≈ütirildi');
            }

            generateHistoricalData() {
                // Generate 30 days of historical price data
                this.historicalData = {
                    'Patates': this.generatePriceHistory(9.5, 10.3, 30),
                    'Soƒüan': this.generatePriceHistory(13.5, 14.2, 30),
                    'Domates': this.generatePriceHistory(12.0, 11.6, 30),
                    'Et': this.generatePriceHistory(85.0, 89.5, 30),
                    'Yaƒü': this.generatePriceHistory(42.5, 42.8, 30)
                };
            }

            generatePriceHistory(startPrice, endPrice, days) {
                const history = [];
                const totalChange = endPrice - startPrice;
                const dailyChange = totalChange / (days - 1);
                
                for (let i = 0; i < days; i++) {
                    const basePrice = startPrice + (dailyChange * i);
                    // Add some random variation (¬±5%)
                    const variation = (Math.random() - 0.5) * 0.1 * basePrice;
                    const price = Math.max(0, basePrice + variation);
                    
                    history.push({
                        date: new Date(Date.now() - (days - i - 1) * 24 * 60 * 60 * 1000),
                        price: Math.round(price * 10) / 10
                    });
                }
                
                return history;
            }

            setupTrendControls() {
                // Period buttons
                document.querySelectorAll('.trend-button[data-period]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const period = parseInt(e.target.dataset.period);
                        this.switchTrendPeriod(period);
                    });
                });

                // Export button
                document.getElementById('exportTrendBtn').addEventListener('click', () => {
                    this.exportTrendToPDF();
                });
            }

            switchTrendPeriod(period) {
                document.querySelectorAll('.trend-button[data-period]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-period="${period}"]`).classList.add('active');
                
                console.log(`üìà Trend periyodu: ${period} g√ºn`);
                this.updateTrendTable(period);
            }

            updateTrendTable(period) {
                const tbody = document.getElementById('trendTableBody');
                tbody.innerHTML = '';

                Object.entries(this.historicalData).forEach(([product, history]) => {
                    const relevantHistory = history.slice(-period);
                    const startPrice = relevantHistory[0].price;
                    const endPrice = relevantHistory[relevantHistory.length - 1].price;
                    const change = endPrice - startPrice;
                    const changePercent = ((change / startPrice) * 100);
                    
                    const row = document.createElement('tr');
                    
                    // Product
                    const productCell = document.createElement('td');
                    productCell.textContent = `${this.getProductIcon(product)} ${product}`;
                    
                    // Current Price
                    const currentCell = document.createElement('td');
                    const currentClass = change > 0 ? 'positive' : change < 0 ? 'negative' : 'neutral';
                    currentCell.innerHTML = `<span class="price-change ${currentClass}">${endPrice}‚Ç∫</span>`;
                    
                    // Period Ago Price
                    const pastCell = document.createElement('td');
                    pastCell.innerHTML = `<span class="price-change neutral">${startPrice}‚Ç∫</span>`;
                    
                    // Average Change
                    const avgChangeCell = document.createElement('td');
                    const avgChangeClass = change > 0 ? 'positive' : change < 0 ? 'negative' : 'neutral';
                    const changeSymbol = change > 0 ? '+' : '';
                    avgChangeCell.innerHTML = `<span class="price-change ${avgChangeClass}">${changeSymbol}${change.toFixed(1)}‚Ç∫</span>`;
                    
                    // Direction
                    const directionCell = document.createElement('td');
                    const trendClass = change > 0 ? 'trend-up' : change < 0 ? 'trend-down' : 'trend-stable';
                    const trendIcon = change > 0 ? '‚¨ÜÔ∏è' : change < 0 ? '‚¨áÔ∏è' : '‚ÜîÔ∏è';
                    const trendText = change > 0 ? 'Artƒ±≈ü' : change < 0 ? 'D√º≈ü√º≈ü' : 'Sabit';
                    directionCell.innerHTML = `
                        <div class="trend-direction">
                            <span class="trend-icon ${trendClass}">${trendIcon}</span>
                            <span>${trendText}</span>
                        </div>
                    `;
                    
                    // Change Percentage
                    const percentCell = document.createElement('td');
                    const percentClass = changePercent > 0 ? 'positive' : changePercent < 0 ? 'negative' : 'neutral';
                    const percentSymbol = changePercent > 0 ? '+' : '';
                    percentCell.innerHTML = `<span class="price-change ${percentClass}">${percentSymbol}${changePercent.toFixed(1)}%</span>`;
                    
                    // Sparkline
                    const sparklineCell = document.createElement('td');
                    sparklineCell.innerHTML = `<span class="sparkline">${this.generateSparkline(relevantHistory)}</span>`;
                    
                    row.appendChild(productCell);
                    row.appendChild(currentCell);
                    row.appendChild(pastCell);
                    row.appendChild(avgChangeCell);
                    row.appendChild(directionCell);
                    row.appendChild(percentCell);
                    row.appendChild(sparklineCell);
                    
                    tbody.appendChild(row);
                });

                // Update summary cards
                this.updateTrendSummary(period);
            }

            generateSparkline(history) {
                // Generate simple sparkline using Unicode blocks
                const prices = history.map(h => h.price);
                const min = Math.min(...prices);
                const max = Math.max(...prices);
                const range = max - min;
                
                if (range === 0) return '‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ'; // Flat line if no change
                
                const blocks = ['‚ñÅ', '‚ñÇ', '‚ñÉ', '‚ñÑ', '‚ñÖ', '‚ñÜ', '‚ñá', '‚ñà'];
                
                return history.slice(-5).map(h => {
                    const normalized = (h.price - min) / range;
                    const blockIndex = Math.min(7, Math.floor(normalized * 8));
                    return blocks[blockIndex];
                }).join('');
            }

            updateTrendSummary(period) {
                let rising = 0;
                let falling = 0;
                let totalChange = 0;
                let maxChange = 0;

                Object.entries(this.historicalData).forEach(([product, history]) => {
                    const relevantHistory = history.slice(-period);
                    const startPrice = relevantHistory[0].price;
                    const endPrice = relevantHistory[relevantHistory.length - 1].price;
                    const change = endPrice - startPrice;
                    const changePercent = Math.abs((change / startPrice) * 100);
                    
                    if (change > 0) rising++;
                    else if (change < 0) falling++;
                    
                    totalChange += (change / startPrice) * 100;
                    maxChange = Math.max(maxChange, Math.abs(change));
                });

                // Update summary cards
                document.querySelector('.trend-summary-card:nth-child(1) .trend-summary-value').textContent = rising;
                document.querySelector('.trend-summary-card:nth-child(2) .trend-summary-value').textContent = falling;
                
                const avgChange = totalChange / Object.keys(this.historicalData).length;
                const avgSymbol = avgChange > 0 ? '+' : '';
                document.querySelector('.trend-summary-card:nth-child(3) .trend-summary-value').textContent = `${avgSymbol}${avgChange.toFixed(1)}%`;
                
                document.querySelector('.trend-summary-card:nth-child(4) .trend-summary-value').textContent = `‚Ç∫${maxChange.toFixed(1)}`;
                
                // Update period labels
                const periodText = period === 30 ? '30 g√ºnl√ºk' : period === 7 ? '7 g√ºnl√ºk' : 'g√ºnl√ºk';
                document.querySelector('.trend-summary-card:nth-child(3) .trend-summary-detail').textContent = `${periodText} ortalama`;
            }

            exportTrendToPDF() {
                console.log('üìÑ Trend analizi PDF\'e aktarƒ±lƒ±yor...');
                
                // Create simple PDF export simulation
                const trendData = this.collectTrendData();
                const pdfContent = this.generatePDFContent(trendData);
                
                // Simulate PDF generation
                const blob = new Blob([pdfContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `procheff-trend-analizi-${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                console.log('‚úÖ Trend raporu ba≈üarƒ±yla aktarƒ±ldƒ±');
            }

            collectTrendData() {
                const data = [];
                Object.entries(this.historicalData).forEach(([product, history]) => {
                    const recent = history.slice(-30);
                    const startPrice = recent[0].price;
                    const endPrice = recent[recent.length - 1].price;
                    const change = endPrice - startPrice;
                    const changePercent = ((change / startPrice) * 100);
                    
                    data.push({
                        product,
                        startPrice,
                        endPrice,
                        change,
                        changePercent,
                        direction: change > 0 ? 'Artƒ±≈ü' : change < 0 ? 'D√º≈ü√º≈ü' : 'Sabit'
                    });
                });
                return data;
            }

            generatePDFContent(trendData) {
                let content = `ProCheff Piyasa Trend Analizi Raporu\n`;
                content += `Tarih: ${new Date().toLocaleDateString('tr-TR')}\n`;
                content += `Analiz Periyodu: Son 30 G√ºn\n\n`;
                
                content += `FIYAT HAREKET √ñZETƒ∞:\n`;
                content += `===================\n\n`;
                
                trendData.forEach(item => {
                    content += `${item.product}:\n`;
                    content += `  G√ºncel Fiyat: ${item.endPrice}‚Ç∫/kg\n`;
                    content += `  √ñnceki Fiyat: ${item.startPrice}‚Ç∫/kg\n`;
                    content += `  Deƒüi≈üim: ${item.change > 0 ? '+' : ''}${item.change.toFixed(1)}‚Ç∫\n`;
                    content += `  Y√ºzde: ${item.changePercent > 0 ? '+' : ''}${item.changePercent.toFixed(1)}%\n`;
                    content += `  Y√∂n: ${item.direction}\n\n`;
                });
                
                content += `Bu rapor ProCheff Piyasa Trend Zek√¢sƒ± (Faz 8) tarafƒ±ndan otomatik olarak olu≈üturulmu≈ütur.\n`;
                content += `Not: Bu veriler sadece fiyat farkƒ±nƒ± g√∂sterir, herhangi bir satƒ±n alma tavsiyesi i√ßermez.\n`;
                
                return content;
            }

            highlightDeviations() {
                console.log('üìä Sapma analizi vurgulanƒ±yor...');
                // Add special highlighting for deviation analysis
            }

            highlightFreshness() {
                console.log('üïí Tazelik kontrol√º vurgulanƒ±yor...');
                // Add special highlighting for freshness analysis
            }

            getProductIcon(product) {
                const icons = {
                    'Patates': 'ü•î',
                    'Soƒüan': 'üßÖ',
                    'Et': 'ü•©',
                    'Yaƒü': 'ü´í',
                    'Baharat': 'üå∂Ô∏è'
                };
                return icons[product] || 'üì¶';
            }

            generateComparisonTable() {
                const recipeData = this.marketData[this.selectedRecipe];
                const tbody = document.getElementById('comparisonTableBody');
                tbody.innerHTML = '';

                Object.entries(recipeData.markets).forEach(([marketName, data]) => {
                    const row = document.createElement('tr');
                    
                    // Market name with logo
                    const marketCell = document.createElement('td');
                    marketCell.innerHTML = `
                        <span class="market-logo">${this.getMarketLogo(marketName)}</span>
                        ${marketName}
                    `;
                    
                    // Total cost with color coding
                    const costCell = document.createElement('td');
                    const costClass = this.getCostClass(data.total, recipeData.markets);
                    costCell.innerHTML = `<span class="cost-value ${costClass}">‚Ç∫${data.total.toLocaleString()}</span>`;
                    
                    // Quality score with bar
                    const qualityCell = document.createElement('td');
                    qualityCell.innerHTML = `
                        <div class="quality-score">
                            <div class="quality-bar">
                                <div class="quality-fill" style="width: ${data.quality * 100}%; background: ${this.getQualityColor(data.quality)};"></div>
                            </div>
                            <span>${(data.quality * 100).toFixed(0)}%</span>
                        </div>
                    `;
                    
                    // Freshness
                    const freshnessCell = document.createElement('td');
                    freshnessCell.textContent = data.freshness;
                    
                    // Suitability
                    const suitabilityCell = document.createElement('td');
                    suitabilityCell.textContent = `${data.suitability}%`;
                    
                    // Status badge
                    const statusCell = document.createElement('td');
                    const statusBadge = this.getStatusBadge(data.suitability);
                    statusCell.innerHTML = statusBadge;
                    
                    row.appendChild(marketCell);
                    row.appendChild(costCell);
                    row.appendChild(qualityCell);
                    row.appendChild(freshnessCell);
                    row.appendChild(suitabilityCell);
                    row.appendChild(statusCell);
                    
                    tbody.appendChild(row);
                });
            }

            generateAIRecommendation() {
                const recipeData = this.marketData[this.selectedRecipe];
                const markets = recipeData.markets;
                
                // Find best options
                const cheapest = Object.entries(markets).reduce((a, b) => a[1].total < b[1].total ? a : b);
                const highest_quality = Object.entries(markets).reduce((a, b) => a[1].quality > b[1].quality ? a : b);
                const best_balance = Object.entries(markets).reduce((a, b) => 
                    (a[1].suitability * a[1].quality) > (b[1].suitability * b[1].quality) ? a : b
                );

                // Generate recommendation
                const recommendationContent = document.getElementById('recommendationContent');
                recommendationContent.innerHTML = `
                    <strong>üìä Maliyet Sim√ºlasyonu tamamlandƒ±.</strong><br><br>
                    <strong>En uygun kombinasyon:</strong> ${best_balance[0]} (Denge)<br>
                    <strong>Toplam maliyet:</strong> ‚Ç∫${best_balance[1].total.toLocaleString()}<br>
                    <strong>Kalite skoru:</strong> %${(best_balance[1].quality * 100).toFixed(0)}<br>
                    <strong>Uygunluk oranƒ±:</strong> %${best_balance[1].suitability}<br><br>
                    ‚Üí Sistem: "Fiyat/kalite dengesi optimum."
                `;

                // Generate thinking chain
                const thinkingChain = document.getElementById('thinkingChain');
                thinkingChain.innerHTML = `
                    <div class="thinking-step">
                        <span class="step-icon">‚Üí</span>
                        <span>"${cheapest[0]} en ucuz (‚Ç∫${cheapest[1].total.toLocaleString()}) ama kalite ${(cheapest[1].quality * 100).toFixed(0)}%"</span>
                    </div>
                    <div class="thinking-step">
                        <span class="step-icon">‚Üí</span>
                        <span>"${highest_quality[0]} en kaliteli (%${(highest_quality[1].quality * 100).toFixed(0)}) ama pahalƒ± (‚Ç∫${highest_quality[1].total.toLocaleString()})"</span>
                    </div>
                    <div class="thinking-step">
                        <span class="step-icon">‚Üí</span>
                        <span>"${best_balance[0]} fiyat/kalite dengesi en iyi (%${best_balance[1].suitability} uygunluk)"</span>
                    </div>
                    <div class="thinking-step">
                        <span class="step-icon">‚Üí</span>
                        <span>"Tazelik ve g√ºvenilirlik fakt√∂rleri de ${best_balance[0]} lehine"</span>
                    </div>
                `;
            }

            getMarketLogo(marketName) {
                const logos = {
                    'A101': 'üõí',
                    'Bƒ∞M': 'üõçÔ∏è',
                    '≈ûOK': '‚ö°',
                    'Metro': 'üè¢',
                    'Migros': 'üè™',
                    'Tarƒ±m Kredi': 'üåæ'
                };
                return logos[marketName] || 'üè™';
            }

            getCostClass(cost, allMarkets) {
                const costs = Object.values(allMarkets).map(m => m.total);
                const min = Math.min(...costs);
                const max = Math.max(...costs);
                const range = max - min;
                
                if (cost <= min + range * 0.33) return 'cost-low';
                if (cost <= min + range * 0.66) return 'cost-medium';
                return 'cost-high';
            }

            getQualityColor(quality) {
                if (quality >= 0.9) return 'var(--cost-green)';
                if (quality >= 0.8) return 'var(--cost-yellow)';
                return 'var(--cost-red)';
            }

            getStatusBadge(suitability) {
                if (suitability >= 92) {
                    return '<span class="status-badge status-good">üü¢ Mantƒ±klƒ±</span>';
                } else if (suitability >= 85) {
                    return '<span class="status-badge status-medium">üü° Orta</span>';
                } else {
                    return '<span class="status-badge status-risky">üî¥ Riskli</span>';
                }
            }

            showWelcomeMessage() {
                console.log('üí∞ ProCheff Maliyet Sim√ºlasyonu v1.0 - Faz 7');
                console.log('üè™ 6 Market Kar≈üƒ±la≈ütƒ±rmasƒ±:');
                console.log('   ‚Ä¢ A101, Bƒ∞M, ≈ûOK, Metro, Migros, Tarƒ±m Kredi');
                console.log('üß† AI Mantƒ±k Modeli aktif');
                console.log('üìä Kalite + Maliyet optimizasyonu hazƒ±r');
                console.log('‚úÖ Sistem operasyonel');
            }

            // Faz 7.3: Karma Kombinasyon AI Methods
            initializeCombinationAI() {
                console.log('üß† Faz 7.3: Karma Kombinasyon AI\'ƒ± ba≈ülatƒ±lƒ±yor...');
                
                // Generate optimal combination
                this.generateOptimalCombination();
                
                // Show combination analysis
                document.getElementById('combinationAI').style.display = 'block';
                
                console.log('‚úÖ Faz 7.3: Karma Kombinasyon AI aktif');
            }

            generateOptimalCombination() {
                // AI optimization algorithm
                const ingredients = ['Patates', 'Soƒüan', 'Et', 'Yaƒü'];
                const markets = ['A101', 'Bƒ∞M', 'Metro', 'Migros', '≈ûOK', 'Tarƒ±m Kredi'];
                
                // Simulate AI decision making for each ingredient
                const optimalSelection = {
                    'Patates': {
                        market: 'A101',
                        reason: 'En Ucuz (9.5‚Ç∫/kg)',
                        savings: 23,
                        distance: 2.1,
                        score: 78
                    },
                    'Soƒüan': {
                        market: 'Metro',
                        reason: 'Kalite/Fiyat Dengesi',
                        savings: 15,
                        distance: 3.4,
                        score: 85
                    },
                    'Et': {
                        market: 'Migros',
                        reason: 'En Kaliteli',
                        savings: -8, // Premium i√ßin biraz pahalƒ±
                        distance: 1.8,
                        score: 98
                    },
                    'Yaƒü': {
                        market: 'Bƒ∞M',
                        reason: 'Fiyat Avantajƒ±',
                        savings: 18,
                        distance: 1.2,
                        score: 82
                    }
                };

                // Update UI with optimal selection
                this.updateOptimalCombination(optimalSelection);
                
                // Calculate optimization score
                const overallScore = this.calculateOptimizationScore(optimalSelection);
                document.getElementById('optimizationScore').textContent = `${overallScore}%`;
                
                // Generate AI logic explanation
                this.generateAILogic(optimalSelection);
                
                // Update comparison table
                this.updateCombinationComparison(optimalSelection);
            }

            updateOptimalCombination(selection) {
                Object.entries(selection).forEach(([ingredient, data]) => {
                    const ingredientKey = ingredient.toLowerCase();
                    const container = document.querySelector(`[data-ingredient="${ingredientKey}"]`);
                    
                    if (container) {
                        // Update assigned market
                        const marketName = container.querySelector('.market-name');
                        const marketLogo = container.querySelector('.market-logo');
                        const assignmentReason = container.querySelector('.assignment-reason');
                        
                        if (marketName) marketName.textContent = data.market;
                        if (marketLogo) marketLogo.textContent = this.getMarketLogo(data.market);
                        if (assignmentReason) assignmentReason.textContent = data.reason;
                        
                        // Update metrics
                        const metrics = container.querySelectorAll('.metric');
                        if (metrics[0]) {
                            const savingsText = data.savings > 0 ? `üí∞ %${data.savings} tasarruf` : `üí∞ %${Math.abs(data.savings)} premium`;
                            metrics[0].textContent = savingsText;
                        }
                        if (metrics[1]) {
                            metrics[1].textContent = `üìç ${data.distance}km mesafe`;
                        }
                    }
                });
            }

            calculateOptimizationScore(selection) {
                let totalScore = 0;
                let totalWeight = 0;
                
                Object.entries(selection).forEach(([ingredient, data]) => {
                    // Weight critical ingredients more
                    const weight = ingredient === 'Et' ? 2 : 1;
                    totalScore += (data.score * weight);
                    totalWeight += weight;
                });
                
                const averageScore = totalScore / totalWeight;
                
                // Apply logistics penalty for multiple markets
                const uniqueMarkets = new Set(Object.values(selection).map(s => s.market)).size;
                const logisticsPenalty = (uniqueMarkets - 1) * 2; // 2% penalty per additional market
                
                return Math.max(70, Math.round(averageScore - logisticsPenalty));
            }

            generateAILogic(selection) {
                const logicSteps = document.getElementById('logicSteps');
                logicSteps.innerHTML = '';
                
                const steps = [
                    {
                        number: 1,
                        content: `<strong>Patates ‚Üí ${selection.Patates.market}:</strong> ${selection.Patates.reason}, %${selection.Patates.savings} tasarruf saƒülƒ±yor. Kalite skoru yeterli (%${selection.Patates.score}).`
                    },
                    {
                        number: 2,
                        content: `<strong>Soƒüan ‚Üí ${selection.Soƒüan.market}:</strong> Fiyat/kalite dengesi optimal. %${selection.Soƒüan.savings} verimlilik artƒ±≈üƒ±.`
                    },
                    {
                        number: 3,
                        content: `<strong>Et ‚Üí ${selection.Et.market}:</strong> Kritik √ºr√ºn i√ßin kalite √∂ncelikli. %${selection.Et.score} g√ºven skoru ile risk minimize.`
                    },
                    {
                        number: 4,
                        content: `<strong>Lojistik Fakt√∂r:</strong> 4 farklƒ± market, ortalama ${this.calculateAverageDistance(selection)}km mesafe. Toplam ula≈üƒ±m maliyeti ‚Ç∫12.`
                    }
                ];

                steps.forEach(step => {
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'logic-step';
                    stepDiv.innerHTML = `
                        <span class="step-number">${step.number}</span>
                        <div class="step-content">${step.content}</div>
                    `;
                    logicSteps.appendChild(stepDiv);
                });
            }

            calculateAverageDistance(selection) {
                const distances = Object.values(selection).map(s => s.distance);
                const average = distances.reduce((a, b) => a + b, 0) / distances.length;
                return average.toFixed(1);
            }

            updateCombinationComparison(selection) {
                // Calculate costs for different scenarios
                const aiOptimalCost = 10240;
                const singleCheapCost = 10980;
                const singleQualityCost = 11850;
                
                // Update table values (already in HTML, but could be dynamic)
                console.log('üìä Kombinasyon kar≈üƒ±la≈ütƒ±rmasƒ± g√ºncellendi');
                
                // Calculate advantages
                const cheapAdvantage = ((singleCheapCost - aiOptimalCost) / aiOptimalCost * 100).toFixed(0);
                const qualityAdvantage = ((singleQualityCost - aiOptimalCost) / aiOptimalCost * 100).toFixed(0);
                
                console.log(`üéØ AI Optimal avantajƒ±: Ucuza kar≈üƒ± +${cheapAdvantage}%, Kaliteye kar≈üƒ± +${qualityAdvantage}%`);
            }

            // Faz 7.4: Kalite Katsayƒ±sƒ± Entegrasyonu Methods
            initializeQualityIntegration() {
                console.log('‚ö° Faz 7.4: Kalite Katsayƒ±sƒ± Entegrasyonu ba≈ülatƒ±lƒ±yor...');
                
                // Calculate effective costs with quality penalty
                this.calculateEffectiveCosts();
                
                // Generate risk matrix
                this.generateRiskMatrix();
                
                // Calculate confidence score
                this.calculateConfidenceScore();
                
                // Show quality integration
                document.getElementById('qualityIntegration').style.display = 'block';
                
                console.log('‚úÖ Faz 7.4: Kalite Katsayƒ±sƒ± aktif');
            }

            calculateEffectiveCosts() {
                // Base costs from optimal combination
                const baseCosts = {
                    'Patates': { market: 'A101', basePrice: 9.5, quality: 78, quantity: 5 },
                    'Soƒüan': { market: 'Metro', basePrice: 13.8, quality: 85, quantity: 3 },
                    'Et': { market: 'Migros', basePrice: 87.0, quality: 98, quantity: 2 },
                    'Yaƒü': { market: 'Bƒ∞M', basePrice: 41.5, quality: 82, quantity: 1 }
                };

                let rawCost = 0;
                let totalRiskPremium = 0;

                // Calculate penalties and effective costs
                Object.entries(baseCosts).forEach(([product, data]) => {
                    const productCost = data.basePrice * data.quantity;
                    rawCost += productCost;

                    // Quality penalty calculation
                    const qualityPenalty = this.calculateQualityPenalty(data.quality, data.basePrice);
                    const penaltyCost = qualityPenalty * data.quantity;
                    totalRiskPremium += penaltyCost;
                });

                const effectiveCost = rawCost + totalRiskPremium;

                // Update UI
                document.getElementById('rawCost').textContent = `‚Ç∫${rawCost.toLocaleString()}`;
                document.getElementById('riskPremium').textContent = `+‚Ç∫${Math.round(totalRiskPremium)}`;
                document.getElementById('effectiveCost').textContent = `‚Ç∫${Math.round(effectiveCost).toLocaleString()}`;

                return { rawCost, totalRiskPremium, effectiveCost };
            }

            calculateQualityPenalty(qualityScore, basePrice) {
                // Quality penalty formula based on quality score
                if (qualityScore >= 95) return basePrice * 0.005; // 0.5% penalty for premium
                if (qualityScore >= 85) return basePrice * 0.03;  // 3% penalty for good
                if (qualityScore >= 75) return basePrice * 0.08;  // 8% penalty for average
                return basePrice * 0.15; // 15% penalty for poor quality
            }

            generateRiskMatrix() {
                const riskData = [
                    {
                        product: 'ü•î Patates',
                        market: 'üõí A101',
                        basePrice: '‚Ç∫9.5/kg',
                        quality: 78,
                        riskLevel: 'D√º≈ü√ºk',
                        penalty: '+‚Ç∫0.8/kg',
                        effectivePrice: '‚Ç∫10.3/kg',
                        riskClass: 'risk-low'
                    },
                    {
                        product: 'üßÖ Soƒüan',
                        market: 'üè¢ Metro',
                        basePrice: '‚Ç∫13.8/kg',
                        quality: 85,
                        riskLevel: 'D√º≈ü√ºk',
                        penalty: '+‚Ç∫0.4/kg',
                        effectivePrice: '‚Ç∫14.2/kg',
                        riskClass: 'risk-low'
                    },
                    {
                        product: 'ü•© Et',
                        market: 'üè™ Migros',
                        basePrice: '‚Ç∫87.0/kg',
                        quality: 98,
                        riskLevel: '√áok D√º≈ü√ºk',
                        penalty: '+‚Ç∫0.5/kg',
                        effectivePrice: '‚Ç∫87.5/kg',
                        riskClass: 'risk-very-low'
                    },
                    {
                        product: 'ü´í Yaƒü',
                        market: 'üõçÔ∏è Bƒ∞M',
                        basePrice: '‚Ç∫41.5/kg',
                        quality: 82,
                        riskLevel: 'Orta',
                        penalty: '+‚Ç∫1.8/kg',
                        effectivePrice: '‚Ç∫43.3/kg',
                        riskClass: 'risk-medium'
                    }
                ];

                const tbody = document.getElementById('riskMatrixBody');
                tbody.innerHTML = '';

                riskData.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = item.riskClass;
                    
                    row.innerHTML = `
                        <td>${item.product}</td>
                        <td>${item.market}</td>
                        <td>${item.basePrice}</td>
                        <td><span class="quality-score">${item.quality}%</span></td>
                        <td><span class="risk-factor ${item.riskClass}">${item.riskLevel}</span></td>
                        <td>${item.penalty}</td>
                        <td class="effective-price">${item.effectivePrice}</td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }

            calculateConfidenceScore() {
                // Market reputation scores
                const marketReputations = {
                    'A101': 78,
                    'Metro': 92,
                    'Migros': 96,
                    'Bƒ∞M': 84
                };

                // Product freshness consistency (last 3 months)
                const freshnessConsistency = {
                    'Patates': 85,
                    'Soƒüan': 89,
                    'Et': 94,
                    'Yaƒü': 88
                };

                // Calculate weighted confidence score
                const reputationAvg = Object.values(marketReputations).reduce((a, b) => a + b, 0) / Object.values(marketReputations).length;
                const freshnessAvg = Object.values(freshnessConsistency).reduce((a, b) => a + b, 0) / Object.values(freshnessConsistency).length;
                
                const overallConfidence = Math.round((reputationAvg * 0.6 + freshnessAvg * 0.4));
                const riskPremiumRate = 3.0; // Average penalty rate

                // Update UI
                document.getElementById('confidenceScore').textContent = `${overallConfidence}%`;
                
                // Update metric cards (static values in HTML are fine for demo)
                console.log(`üõ°Ô∏è G√ºven Skoru: ${overallConfidence}%, Risk Primi: ${riskPremiumRate}%`);
                
                return overallConfidence;
            }

            // Faz 7.5: Piyasa Hafƒ±zasƒ± √ñƒürenme Methods
            initializeMarketMemory() {
                console.log('üß† Faz 7.5: Piyasa Hafƒ±zasƒ± √ñƒürenme ba≈ülatƒ±lƒ±yor...');
                
                // Initialize learning system
                this.setupLearningSystem();
                
                // Update learning metrics
                this.updateLearningMetrics();
                
                // Simulate pattern recognition
                this.simulatePatternRecognition();
                
                // Show market memory
                document.getElementById('marketMemory').style.display = 'block';
                
                console.log('‚úÖ Faz 7.5: Piyasa Hafƒ±zasƒ± aktif');
            }

            setupLearningSystem() {
                // Initialize learning data structure
                this.learningData = {
                    dataPoints: 1247,
                    learningDays: 89,
                    accuracyRate: 91.3,
                    version: '2.8',
                    patterns: {
                        priceCorrelation: { confidence: 94, status: 'detected' },
                        seasonalCycle: { confidence: 87, status: 'detected' },
                        marketBehavior: { confidence: 62, status: 'learning' },
                        suddenChange: { confidence: 31, status: 'pending' }
                    },
                    coefficients: {
                        priceWeight: { initial: 0.45, current: 0.52, change: 0.07 },
                        qualityWeight: { initial: 0.35, current: 0.28, change: -0.07 },
                        distanceWeight: { initial: 0.20, current: 0.20, change: 0.00 }
                    }
                };

                // Simulate continuous learning (update every 30 seconds)
                this.startLearningSimulation();
            }

            startLearningSimulation() {
                setInterval(() => {
                    this.simulateLearningUpdate();
                }, 30000); // Update every 30 seconds
            }

            simulateLearningUpdate() {
                // Simulate small learning updates
                this.learningData.dataPoints += Math.floor(Math.random() * 5) + 1;
                this.learningData.accuracyRate += (Math.random() - 0.5) * 0.5;
                this.learningData.accuracyRate = Math.max(85, Math.min(95, this.learningData.accuracyRate));

                // Update UI
                document.getElementById('dataPoints').textContent = this.learningData.dataPoints.toLocaleString();
                document.getElementById('accuracyRate').textContent = `${this.learningData.accuracyRate.toFixed(1)}%`;

                // Update learning progress
                const currentProgress = parseInt(document.getElementById('learningProgress').style.width) || 73;
                const newProgress = Math.min(95, currentProgress + Math.random() * 2);
                document.getElementById('learningProgress').style.width = `${newProgress}%`;
                document.getElementById('learningText').textContent = `${Math.round(newProgress)}% √ñƒürenme`;

                console.log(`üîÑ Sistem √∂ƒüreniyor: ${this.learningData.dataPoints} veri noktasƒ±, %${this.learningData.accuracyRate.toFixed(1)} doƒüruluk`);
            }

            updateLearningMetrics() {
                // Update basic metrics
                document.getElementById('dataPoints').textContent = this.learningData.dataPoints.toLocaleString();
                document.getElementById('learningDays').textContent = this.learningData.learningDays;
                document.getElementById('accuracyRate').textContent = `${this.learningData.accuracyRate}%`;
                document.getElementById('adaptationCycle').textContent = `v${this.learningData.version}`;
            }

            simulatePatternRecognition() {
                // Simulate pattern detection updates
                const patterns = document.querySelectorAll('.pattern-card');
                
                // Randomly update pattern confidence over time
                setTimeout(() => {
                    const learningPattern = document.querySelector('.pattern-card.learning .pattern-confidence');
                    if (learningPattern) {
                        const newConfidence = 62 + Math.floor(Math.random() * 15);
                        learningPattern.textContent = `G√ºven: ${newConfidence}%`;
                        
                        if (newConfidence > 75) {
                            // Pattern learned, change status
                            const card = learningPattern.closest('.pattern-card');
                            card.classList.remove('learning');
                            card.classList.add('detected');
                            card.querySelector('.detection-badge').textContent = 'Tespit Edildi';
                            card.querySelector('.detection-badge').classList.remove('learning');
                        }
                    }
                }, 45000); // After 45 seconds

                console.log('üß© Pattern tanƒ±ma sistemi aktif');
            }

            // Adaptive coefficient adjustment
            simulateUserBehavior(preferenceType) {
                // Simulate user preference learning
                if (preferenceType === 'price-focused') {
                    this.learningData.coefficients.priceWeight.current += 0.05;
                    this.learningData.coefficients.qualityWeight.current -= 0.05;
                } else if (preferenceType === 'quality-focused') {
                    this.learningData.coefficients.qualityWeight.current += 0.05;
                    this.learningData.coefficients.priceWeight.current -= 0.05;
                }

                // Update coefficient display
                this.updateCoefficientDisplay();
                
                // Add to learning history
                this.addLearningHistory(preferenceType);
            }

            updateCoefficientDisplay() {
                const coefficients = this.learningData.coefficients;
                
                // Update current weights (static for demo, but could be dynamic)
                console.log('‚öôÔ∏è Katsayƒ±lar g√ºncellendi:', coefficients);
            }

            addLearningHistory(event) {
                // Add new learning event to timeline
                const timeline = document.querySelector('.history-timeline');
                const newItem = document.createElement('div');
                newItem.className = 'timeline-item recent';
                newItem.innerHTML = `
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <div class="timeline-title">Yeni Davranƒ±≈ü √ñƒürenildi</div>
                        <div class="timeline-details">${event} tercihi sistem tarafƒ±ndan kaydedildi</div>
                        <div class="timeline-time">Az √∂nce</div>
                    </div>
                `;
                
                // Remove recent class from old items
                timeline.querySelectorAll('.recent').forEach(item => {
                    item.classList.remove('recent');
                });
                
                // Add new item at top
                timeline.insertBefore(newItem, timeline.firstChild);
                
                console.log('üìö √ñƒürenme ge√ßmi≈üine eklendi:', event);
            }
        }

        // Initialize Cost Simulation System
        document.addEventListener('DOMContentLoaded', () => {
            window.costSimulation = new CostSimulationSystem();
        });
    </script>
</body>
</html>
